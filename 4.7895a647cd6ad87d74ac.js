(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{"4XuV":function(e,t,n){"use strict";n.r(t),n.d(t,"MissionFormModule",(function(){return R}));var i=n("PCNd"),o=n("DUip"),r=n("h/AT"),s=n("TYT/"),m=n("dJ3e"),a=n("9qP0"),p=n("mrSG"),l=n("QJY3"),c=n("1YJq"),u=n("Valr"),d=n("uLXW"),f=n("eHTH"),h=n("cSbt"),g=n("7itd"),y=n("hc/R"),b=n("iYur"),v=n("p+mS"),S=n("Up+3"),I=n("MqYC"),C=n("DjAo");function F(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"mat-error"),s["\u0275\u0275text"](1," Adresse er ett obligatorisk felt p\xe5 maks 100 tegn. "),s["\u0275\u0275elementEnd"]())}function x(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"mat-error"),s["\u0275\u0275text"](1," Kontaktnummer m\xe5 v\xe6re mellom 4 og 12 siffer. "),s["\u0275\u0275elementEnd"]())}function E(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"mat-error"),s["\u0275\u0275text"](1," Beskrivelse er p\xe5 maks 400 tegn. "),s["\u0275\u0275elementEnd"]())}function P(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"mat-option",20),s["\u0275\u0275text"](1),s["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit;s["\u0275\u0275property"]("value",n.name),s["\u0275\u0275advance"](1),s["\u0275\u0275textInterpolate1"](" ",n.name," ")}}function j(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"mat-option",20),s["\u0275\u0275text"](1),s["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit;s["\u0275\u0275property"]("value",n.name),s["\u0275\u0275advance"](1),s["\u0275\u0275textInterpolate1"](" ",n.name," ")}}function T(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"mat-checkbox",21),s["\u0275\u0275text"](1,"Er oppdraget ferdig?"),s["\u0275\u0275elementEnd"]())}function w(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"mat-checkbox",22),s["\u0275\u0275text"](1," Slett n\xe5v\xe6rende forsidebilde? "),s["\u0275\u0275elementEnd"]())}function N(e,t){if(1&e){var n=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"form",1),s["\u0275\u0275elementStart"](1,"mat-form-field"),s["\u0275\u0275elementStart"](2,"input",2,3),s["\u0275\u0275listener"]("onAddressChange",(function(e){return s["\u0275\u0275restoreView"](n),s["\u0275\u0275nextContext"]().handleAddressChange(e)})),s["\u0275\u0275elementEnd"](),s["\u0275\u0275template"](4,F,2,0,"mat-error",4),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](5,"mat-form-field"),s["\u0275\u0275element"](6,"input",5),s["\u0275\u0275template"](7,x,2,0,"mat-error",4),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](8,"mat-form-field"),s["\u0275\u0275elementStart"](9,"textarea",6,7),s["\u0275\u0275text"](11,"              "),s["\u0275\u0275elementEnd"](),s["\u0275\u0275template"](12,E,2,0,"mat-error",4),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](13,"mat-form-field",8),s["\u0275\u0275element"](14,"input",9),s["\u0275\u0275elementStart"](15,"mat-autocomplete",null,10),s["\u0275\u0275template"](17,P,2,2,"mat-option",11),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](18,"mat-form-field",12),s["\u0275\u0275element"](19,"input",13),s["\u0275\u0275elementStart"](20,"mat-autocomplete",null,14),s["\u0275\u0275template"](22,j,2,2,"mat-option",11),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275template"](23,T,2,0,"mat-checkbox",15),s["\u0275\u0275template"](24,w,2,0,"mat-checkbox",16),s["\u0275\u0275elementStart"](25,"span",17),s["\u0275\u0275text"](26," Last opp forsidebilde: "),s["\u0275\u0275elementStart"](27,"input",18),s["\u0275\u0275listener"]("change",(function(e){return s["\u0275\u0275restoreView"](n),s["\u0275\u0275nextContext"]().changeFile(e)})),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](28,"button",19),s["\u0275\u0275listener"]("click",(function(){return s["\u0275\u0275restoreView"](n),s["\u0275\u0275nextContext"]().onSubmit()})),s["\u0275\u0275text"](29),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()}if(2&e){var i=s["\u0275\u0275reference"](16),o=s["\u0275\u0275reference"](21),r=s["\u0275\u0275nextContext"]();s["\u0275\u0275property"]("formGroup",r.missionForm),s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("options",r.googleOptions),s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("ngIf",r.address.invalid),s["\u0275\u0275advance"](3),s["\u0275\u0275property"]("ngIf",r.phoneNumber.invalid),s["\u0275\u0275advance"](5),s["\u0275\u0275property"]("ngIf",r.description.invalid),s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("matAutocomplete",i),s["\u0275\u0275advance"](3),s["\u0275\u0275property"]("ngForOf",r.employers),s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("matAutocomplete",o),s["\u0275\u0275advance"](3),s["\u0275\u0275property"]("ngForOf",r.missionTypes),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",!r.isCreateForm),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",!r.isCreateForm&&r.mission.imageURL),s["\u0275\u0275advance"](4),s["\u0275\u0275property"]("disabled",r.missionForm.invalid||r.missionForm.pristine&&!r.files),s["\u0275\u0275advance"](1),s["\u0275\u0275textInterpolate1"](" ",r.isCreateForm?"Legg til":"Oppdater"," ")}}var k=function(){function e(e){this._formBuilder=e,this.Roles=c.h,this.formSubmitted=new s.EventEmitter,this.googleOptions={types:["geocode"],componentRestrictions:{country:"no"}},this.isStreetAddress=!1,this.isCreateForm=!1}return e.prototype.ngOnInit=function(){this.mission&&null!=this.mission||(this.isCreateForm=!0),this.initalizeForm(this.mission)},e.prototype.initalizeForm=function(e){this.missionForm=this._formBuilder.group({id:e?e.id:null,address:[e?e.address:null,[l.s.required,l.s.maxLength(100)]],phoneNumber:[e?e.phoneNumber:null,[l.s.minLength(4),l.s.maxLength(12)]],description:[e?e.description:null,[l.s.maxLength(400)]],finished:[e?e.finished:null],deleteCurrentImage:[!1],employer:this._formBuilder.group({id:[null],name:[e&&e.employer?e.employer.name:null]}),missionType:this._formBuilder.group({id:[null],name:[e&&e.missionType?e.missionType.name:null]})})},e.prototype.onSubmit=function(){var e=this,t=this.missionTypes.find((function(t){return t.name===e.missionTypeName.value})),n=this.employers.find((function(t){return t.name===e.employerName.value}));t&&this.missionTypeId.setValue(t.id),n&&this.employerId.setValue(n.id);var i=Object(p.a)(Object(p.a)({},this.missionForm.value),{image:this.files?this.files[0]:void 0});this.missionForm.valid&&(this.missionForm.dirty||i.image)&&this.formSubmitted.emit(i)},e.prototype.handleAddressChange=function(e){this.missionForm.controls.address.setValue(e.formatted_address)},e.prototype.changeFile=function(e){this.files=e.target.files},Object.defineProperty(e.prototype,"address",{get:function(){return this.missionForm.get("address")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"phoneNumber",{get:function(){return this.missionForm.get("phoneNumber")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"description",{get:function(){return this.missionForm.get("description")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"employerId",{get:function(){return this.missionForm.get(["employer","id"])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"employerName",{get:function(){return this.missionForm.get(["employer","name"])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"missionTypeId",{get:function(){return this.missionForm.get(["missionType","id"])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"missionTypeName",{get:function(){return this.missionForm.get(["missionType","name"])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"finished",{get:function(){return this.missionForm.get("finished")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"deleteCurrentImage",{get:function(){return this.missionForm.get("deleteCurrentImage")},enumerable:!0,configurable:!0}),e.\u0275fac=function(t){return new(t||e)(s["\u0275\u0275directiveInject"](l.c))},e.\u0275cmp=s["\u0275\u0275defineComponent"]({type:e,selectors:[["app-mission-form-view"]],inputs:{mission:"mission",missionTypes:"missionTypes",employers:"employers"},outputs:{formSubmitted:"formSubmitted"},decls:1,vars:1,consts:[["fxLayout","column",3,"formGroup",4,"ngIf"],["fxLayout","column",3,"formGroup"],["ngx-google-places-autocomplete","","matInput","","placeholder","Adresse","formControlName","address","required","",3,"options","onAddressChange"],["placesRef","ngx-places"],[4,"ngIf"],["matInput","","placeholder","Kontaktnummer","formControlName","phoneNumber"],["matInput","","cdkTextareaAutosize","","placeholder","Beskrivelse","formControlName","description"],["autosize","cdkTextareaAutosize"],["formGroupName","employer"],["matInput","","placeholder","Oppdragsgiver","aria-label","Oppdragsgiver","formControlName","name",3,"matAutocomplete"],["auto1","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["formGroupName","missionType"],["matInput","","placeholder","Oppdragstype","aria-label","Oppdragstype","formControlName","name",3,"matAutocomplete"],["auto2","matAutocomplete"],["formControlName","finished","class","mb-2",4,"ngIf"],["formControlName","deleteCurrentImage","class","mb-1",4,"ngIf"],[1,"mb-2"],["type","file",3,"change"],["appHttpCommandButton","","mat-raised-button","","color","primary",1,"w-100",3,"disabled","click"],[3,"value"],["formControlName","finished",1,"mb-2"],["formControlName","deleteCurrentImage",1,"mb-1"]],template:function(e,t){1&e&&s["\u0275\u0275template"](0,N,30,13,"form",0),2&e&&s["\u0275\u0275property"]("ngIf",t.missionForm)},directives:[u.l,l.t,l.m,d.c,l.e,f.c,h.a,l.b,g.GooglePlaceDirective,l.l,l.d,l.r,y.b,l.f,b.c,b.a,u.k,v.b,S.a,f.b,I.i,C.a],encapsulation:2,changeDetection:0}),e}(),O=function(){function e(e,t,n,i){this.employerService=e,this.missionTypeService=t,this.missionService=n,this.notificationService=i,this.finished=new s.EventEmitter,this.missionTypes$=this.missionTypeService.getAll$(),this.employers$=this.employerService.getAll$(),this.isCreateForm=!1}return e.prototype.ngOnInit=function(){this.idPreset?this.mission$=this.missionService.get$(this.idPreset):this.isCreateForm=!0},e.prototype.onSubmit=function(e){e&&null!=e?this.isCreateForm?this.createMission(e):this.editMission(e):this.finished.emit(null)},e.prototype.createMission=function(e){var t=this;this.missionService.addMission$(e).subscribe((function(e){return t.finished.emit(e.id)}))},e.prototype.editMission=function(e){var t=this;this.missionService.updateMission$(e).subscribe((function(e){t.notificationService.setNotification("Vellykket oppdatering!"),t.finished.emit(e.id)}))},e.\u0275fac=function(t){return new(t||e)(s["\u0275\u0275directiveInject"](m.l),s["\u0275\u0275directiveInject"](m.u),s["\u0275\u0275directiveInject"](m.t),s["\u0275\u0275directiveInject"](m.w))},e.\u0275cmp=s["\u0275\u0275defineComponent"]({type:e,selectors:[["app-mission-form"]],inputs:{idPreset:"idPreset"},outputs:{finished:"finished"},decls:4,vars:9,consts:[[3,"mission","missionTypes","employers","formSubmitted"]],template:function(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"app-mission-form-view",0),s["\u0275\u0275listener"]("formSubmitted",(function(e){return t.onSubmit(e)})),s["\u0275\u0275pipe"](1,"async"),s["\u0275\u0275pipe"](2,"async"),s["\u0275\u0275pipe"](3,"async"),s["\u0275\u0275elementEnd"]()),2&e&&s["\u0275\u0275property"]("mission",t.isCreateForm?null:s["\u0275\u0275pipeBind1"](1,3,t.mission$))("missionTypes",s["\u0275\u0275pipeBind1"](2,5,t.missionTypes$))("employers",s["\u0275\u0275pipeBind1"](3,7,t.employers$))},directives:[k],pipes:[u.b],encapsulation:2,changeDetection:0}),e}(),A=["pdfInput"],$=function(){function e(e,t,n){var i=this;this.missionService=e,this._bottomSheetRef=t,this.data=n,this.close=function(){return i._bottomSheetRef.dismiss()},this.createFromPdf=function(e){return i.missionService.addMissionFromPdfReport$(e).subscribe((function(e){return i.close()}))},this.openPdfInput=function(){return i.pdfInput.nativeElement.click()}}return e.prototype.ngOnInit=function(){this.navConfig={title:this.data&&this.data.idPreset?"Rediger oppdrag":"Registrer oppdrag",leftBtn:{icon:"close",callback:this.close},buttons:[{icon:"note_add",callback:this.openPdfInput}]}},e.\u0275fac=function(t){return new(t||e)(s["\u0275\u0275directiveInject"](m.t),s["\u0275\u0275directiveInject"](r.d),s["\u0275\u0275directiveInject"](r.a))},e.\u0275cmp=s["\u0275\u0275defineComponent"]({type:e,selectors:[["app-mission-form-sheet-wrapper"]],viewQuery:function(e,t){var n;1&e&&s["\u0275\u0275viewQuery"](A,!0),2&e&&s["\u0275\u0275queryRefresh"](n=s["\u0275\u0275loadQuery"]())&&(t.pdfInput=n.first)},decls:4,vars:2,consts:[[3,"config"],[3,"idPreset","finished"],["type","file","multiple","",2,"display","none",3,"change"],["pdfInput",""]],template:function(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"app-simple-top-nav",0),s["\u0275\u0275elementStart"](1,"app-mission-form",1),s["\u0275\u0275listener"]("finished",(function(){return t.close()})),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](2,"input",2,3),s["\u0275\u0275listener"]("change",(function(e){return t.createFromPdf(e.target.files[0])})),s["\u0275\u0275elementEnd"]()),2&e&&(s["\u0275\u0275property"]("config",t.navConfig),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("idPreset",null==t.data?null:t.data.idPreset))},directives:[a.a,O],encapsulation:2,changeDetection:0}),e}(),M=[{path:"",component:function(){function e(e,t,n){var i=this;this.bottomSheet=e,this.route=t,this.location=n,this.openDialog=function(e){i.bottomSheet.open($,{data:e}).afterDismissed().subscribe((function(e){return i.location.back()}))},this.openDialog({idPreset:+this.route.snapshot.queryParams.idPreset})}return e.\u0275fac=function(t){return new(t||e)(s["\u0275\u0275directiveInject"](r.b),s["\u0275\u0275directiveInject"](o.a),s["\u0275\u0275directiveInject"](u.h))},e.\u0275cmp=s["\u0275\u0275defineComponent"]({type:e,selectors:[["ng-component"]],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0}),e}()}],B=function(){function e(){}return e.\u0275mod=s["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=s["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[o.f.forChild(M)],o.f]}),e}(),R=function(){function e(){}return e.\u0275mod=s["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=s["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[i.a,B]]}),e}()}}]);