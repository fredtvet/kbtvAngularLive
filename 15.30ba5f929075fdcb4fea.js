(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{"1eh6":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("K9Ia"),o=n("TYT/"),r=function(){function e(){this.unsubscribe=new i.a}return e.prototype.ngOnDestroy=function(){this.unsubscribe.next(),this.unsubscribe.complete()},e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=o["\u0275\u0275defineDirective"]({type:e}),e}()},"9qP0":function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var i=n("TYT/"),o=n("Valr"),r=n("FfOm"),a=n("qaSM"),s=n("dAsQ");function c(e,t){1&e&&i["\u0275\u0275element"](0,"app-icon-button",4),2&e&&i["\u0275\u0275property"]("config",t.$implicit)}function l(e,t){if(1&e&&(i["\u0275\u0275elementStart"](0,"mat-toolbar",3),i["\u0275\u0275element"](1,"app-icon-button",4),i["\u0275\u0275elementStart"](2,"span",5),i["\u0275\u0275elementStart"](3,"span",6),i["\u0275\u0275text"](4),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275template"](5,c,1,1,"app-icon-button",7),i["\u0275\u0275elementEnd"]()),2&e){var n=i["\u0275\u0275nextContext"]();i["\u0275\u0275property"]("ngClass",n.config.colorClass?n.config.colorClass:"bg-accent"),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("config",n.config.leftBtn),i["\u0275\u0275advance"](3),i["\u0275\u0275textInterpolate"](n.config.title),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngForOf",n.config.buttons)}}var u=["*"],p=function(){function e(){}return e.prototype.ngOnInit=function(){},e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i["\u0275\u0275defineComponent"]({type:e,selectors:[["app-simple-top-nav"]],inputs:{config:"config"},ngContentSelectors:u,decls:4,vars:1,consts:[[1,"column"],["class","toolbar-slim mat-elevation-z2 flex-nav",3,"ngClass",4,"ngIf"],[1,"main-content","p-3"],[1,"toolbar-slim","mat-elevation-z2","flex-nav",3,"ngClass"],[3,"config"],[1,"mr-auto"],[1,"ml-1"],[3,"config",4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(i["\u0275\u0275projectionDef"](),i["\u0275\u0275elementStart"](0,"div",0),i["\u0275\u0275template"](1,l,6,4,"mat-toolbar",1),i["\u0275\u0275elementStart"](2,"div",2),i["\u0275\u0275projection"](3),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]()),2&e&&(i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf",t.config))},directives:[o.l,r.a,o.j,a.a,s.a,o.k],styles:[".column[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column}.main-content[_ngcontent-%COMP%]{flex-grow:1;overflow-y:auto}"],changeDetection:0}),e}()},tnMk:function(e,t,n){"use strict";n.r(t),n.d(t,"MissionModule",(function(){return W}));var i=n("DUip"),o=n("mrSG"),r=n("26FU"),a=n("15JJ"),s=n("67Y/"),c=n("1YJq"),l=n("TYT/"),u=n("dJ3e"),p=n("ea4N"),d=n("Valr"),m=n("h/AT"),f=n("uLXW"),v=n("QDnv"),g=n("pdUi"),h=n("EFs6"),b=n("SRL/"),S=n("p+mS"),y=n("GsDI");function I(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"p",6),l["\u0275\u0275text"](1,"Fant ingen oppdrag"),l["\u0275\u0275elementEnd"]())}var k=function(e){return{startIcon:"home_work",endIcon:e}},x=function(e){return["/oppdrag",e,"detaljer"]};function w(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"app-list-card",7),l["\u0275\u0275text"](1),l["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit;l["\u0275\u0275property"]("config",l["\u0275\u0275pureFunction1"](3,k,n.finished?"check":"chevron_right"))("routerLink",l["\u0275\u0275pureFunction1"](5,x,n.id)),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"]("","("+n.id+") "+n.address," ")}}function M(e,t){if(1&e){var n=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"button",8),l["\u0275\u0275listener"]("click",(function(){return l["\u0275\u0275restoreView"](n),l["\u0275\u0275nextContext"]().openMissionForm()})),l["\u0275\u0275elementStart"](1,"mat-icon"),l["\u0275\u0275text"](2,"add"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()}}var C=function(e,t){return[e,t]},j=function(){function e(e,t,n){var i=this;this._bottomSheet=e,this.router=t,this.route=n,this.Roles=c.i,this.missions=[],this.title="Oppdrag",this.search=new l.EventEmitter,this.onSearch=function(e){return i.search.emit(e)},this.openMissionForm=function(){return i.router.navigate(["ny"],{relativeTo:i.route})},this.trackByFn=function(e,t){return t.id}}return e.prototype.ngOnInit=function(){},e.\u0275fac=function(t){return new(t||e)(l["\u0275\u0275directiveInject"](m.b),l["\u0275\u0275directiveInject"](i.b),l["\u0275\u0275directiveInject"](i.a))},e.\u0275cmp=l["\u0275\u0275defineComponent"]({type:e,selectors:[["app-mission-list-view"]],inputs:{missions:"missions",title:"title"},outputs:{search:"search"},decls:6,vars:7,consts:[["fxLayout","column","fxLayoutAlign","start stretch",1,"h-100","pl-2","pr-2","max-width",2,"overflow","hidden"],["appInputListener","","placeholder","S\xf8k med adresse eller id",1,"mt-2","mb-2","p-2","pl-3","mat-elevation-z2","fadeInDown",2,"background","white","border","none","border-radius","10px",3,"inputChanged"],["class","m-2",4,"ngIf"],["itemSize","60","maxBufferPx","800","minBufferPx","800","fxFlex",""],[3,"config","routerLink",4,"cdkVirtualFor","cdkVirtualForOf","cdkVirtualForTrackBy"],["mat-fab","","aria-label","ny","class","action_fab",3,"click",4,"ifRole"],[1,"m-2"],[3,"config","routerLink"],["mat-fab","","aria-label","ny",1,"action_fab",3,"click"]],template:function(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"div",0),l["\u0275\u0275elementStart"](1,"input",1),l["\u0275\u0275listener"]("inputChanged",(function(e){return t.onSearch(e)})),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](2,I,2,0,"p",2),l["\u0275\u0275elementStart"](3,"cdk-virtual-scroll-viewport",3),l["\u0275\u0275template"](4,w,2,7,"app-list-card",4),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](5,M,3,0,"button",5)),2&e&&(l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("ngIf",null==t.missions||0==t.missions.length),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("cdkVirtualForOf",t.missions)("cdkVirtualForTrackBy",t.trackByFn),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ifRole",l["\u0275\u0275pureFunction2"](4,C,t.Roles.Leder,t.Roles.Mellomleder)))},directives:[f.c,f.b,v.a,d.l,g.e,g.a,f.a,g.d,h.a,b.a,i.c,S.b,y.a],encapsulation:2,changeDetection:0}),e}(),F=n("RHY+");function N(e,t){if(1&e){var n=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"app-mission-list-view",1),l["\u0275\u0275listener"]("search",(function(e){return l["\u0275\u0275restoreView"](n),l["\u0275\u0275nextContext"]().searchMissionList(e)})),l["\u0275\u0275pipe"](1,"sortByDate"),l["\u0275\u0275elementEnd"]()}if(2&e){var i=t.$implicit;l["\u0275\u0275property"]("missions",l["\u0275\u0275pipeBind3"](1,1,i.missions,null!=i.pageInfo&&i.pageInfo.historic?"lastVisited":"updatedAt","desc"))}}var O=function(){function e(e,t,n){var i=this;this.mainNavService=e,this.missionService=t,this.dialog=n,this.Roles=c.i,this.pageInfoSubject=new r.a({searchString:"",showFinishedMissions:!1,historic:!1}),this.searchMissionList=function(e){var t=Object(o.a)({},i.pageInfoSubject.value);t.searchString=e,i.pageInfoSubject.next(t)},this.toggleFinishedMissions=function(){var e=Object(o.a)({},i.pageInfoSubject.value);e.showFinishedMissions=!e.showFinishedMissions,i.pageInfoSubject.next(e);var t="check_box_outline_blank";e.showFinishedMissions&&(t="check_box");var n=i.mainNavService.getTopDefaultNavConfig();n.bottomSheetButtons[0].icon=t,i.mainNavService.addTopNavConfig({default:n})},this.toggleHistoricOrder=function(){var e=Object(o.a)({},i.pageInfoSubject.value);e.historic=!e.historic,i.pageInfoSubject.next(e);var t="color-background";e.historic&&(t="color-accent");var n=i.mainNavService.getTopDefaultNavConfig();n.buttons[0].colorClass=t,i.mainNavService.addTopNavConfig({default:n})},this.configureMainNav()}return e.prototype.ngOnInit=function(){var e=this;this.vm$=this.pageInfoSubject.pipe(Object(a.a)((function(t){return e.missionService.getBy$((function(n){return e.filterMission(n,t)})).pipe(Object(s.a)((function(e){return{missions:e,pageInfo:t}})))})))},e.prototype.filterMission=function(e,t){var n=e.finished==t.showFinishedMissions;n=n&&(!t.searchString||null==t.searchString||e.address.toLowerCase().includes(t.searchString.toLowerCase()));var i=+t.searchString;return isNaN(i)||(n=n||e.id===i),n},e.prototype.configureMainNav=function(){var e={title:"Oppdrag"};e.buttons=[{icon:"history",colorClass:"color-background",aria:"Historisk visning",callback:this.toggleHistoricOrder}],e.bottomSheetButtons=[{text:"Vis ferdige oppdrag",icon:"check_box_outline_blank",callback:this.toggleFinishedMissions}],this.mainNavService.addTopNavConfig({default:e})},e.\u0275fac=function(t){return new(t||e)(l["\u0275\u0275directiveInject"](u.p),l["\u0275\u0275directiveInject"](u.t),l["\u0275\u0275directiveInject"](p.b))},e.\u0275cmp=l["\u0275\u0275defineComponent"]({type:e,selectors:[["app-mission-list"]],decls:3,vars:3,consts:[[3,"missions","search",4,"ngIf"],[3,"missions","search"]],template:function(e,t){1&e&&(l["\u0275\u0275template"](0,N,2,5,"app-mission-list-view",0),l["\u0275\u0275pipe"](1,"async"),l["\u0275\u0275element"](2,"router-outlet")),2&e&&l["\u0275\u0275property"]("ngIf",l["\u0275\u0275pipeBind1"](1,1,t.vm$))},directives:[d.l,i.g,j],pipes:[d.b,F.a],encapsulation:2,changeDetection:0}),e}(),L=n("1ua0"),B=n("VnD/"),D=n("xMyE"),E=n("dzgT"),T=n("MqYC"),R=n("BtvD"),V=function(){return["/oppdrag"]},_=function(){return["/timer"]},$=function(){return{startIcon:"photo_library",ellipsisDisabled:!0}},A=function(e){return["/oppdrag",e,"bilder"]},P=function(){return{startIcon:"folder",ellipsisDisabled:!0}},z=function(e){return["/oppdrag",e,"dokumenter"]},J=function(){return{startIcon:"rate_review",ellipsisDisabled:!0}},Y=function(e){return["/oppdrag",e,"notater"]};function q(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"div",1),l["\u0275\u0275elementStart"](1,"div",2),l["\u0275\u0275elementStart"](2,"a",3),l["\u0275\u0275elementStart"](3,"mat-icon",4),l["\u0275\u0275text"](4,"phone"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](5,"br"),l["\u0275\u0275elementStart"](6,"span"),l["\u0275\u0275text"](7),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](8,"a",5),l["\u0275\u0275elementStart"](9,"mat-icon",6),l["\u0275\u0275text"](10,"directions_car"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](11,"br"),l["\u0275\u0275elementStart"](12,"span"),l["\u0275\u0275text"](13,"Veibeskrivelse"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](14,"app-list-card",7),l["\u0275\u0275elementStart"](15,"span",8),l["\u0275\u0275text"](16,"Bilder"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](17,"app-list-card",7),l["\u0275\u0275elementStart"](18,"span",8),l["\u0275\u0275text"](19,"Dokumenter"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](20,"app-list-card",7),l["\u0275\u0275elementStart"](21,"span",8),l["\u0275\u0275text"](22,"Notater"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e){var n=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](2),l["\u0275\u0275propertyInterpolate1"]("href","tel:",n.vm.mission.phoneNumber,"",l["\u0275\u0275sanitizeUrl"]),l["\u0275\u0275property"]("routerLink",l["\u0275\u0275pureFunction0"](14,V)),l["\u0275\u0275advance"](5),l["\u0275\u0275textInterpolate1"]("",n.vm.mission.phoneNumber||"N/A"," "),l["\u0275\u0275advance"](1),l["\u0275\u0275propertyInterpolate1"]("href","https://www.google.com/maps/dir/?api=1&destination=",n.vm.mission.address,"&travelmode=driving",l["\u0275\u0275sanitizeUrl"]),l["\u0275\u0275property"]("routerLink",l["\u0275\u0275pureFunction0"](15,_)),l["\u0275\u0275advance"](6),l["\u0275\u0275property"]("config",l["\u0275\u0275pureFunction0"](16,$))("routerLink",l["\u0275\u0275pureFunction1"](17,A,n.vm.mission.id)),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("matBadge",n.vm.imageCount),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("config",l["\u0275\u0275pureFunction0"](19,P))("routerLink",l["\u0275\u0275pureFunction1"](20,z,n.vm.mission.id)),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("matBadge",n.vm.documentCount),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("config",l["\u0275\u0275pureFunction0"](22,J))("routerLink",l["\u0275\u0275pureFunction1"](23,Y,n.vm.mission.id)),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("matBadge",n.vm.noteCount)}}var U=function(){function e(){this.Roles=c.i}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=l["\u0275\u0275defineComponent"]({type:e,selectors:[["app-mission-details-view"]],inputs:{vm:"vm"},decls:1,vars:1,consts:[["class","p-2 max-width",4,"ngIf"],[1,"p-2","max-width"],["fxLayout","row","fxLayoutGap","8px",1,"mat-subheading-2","mb-2"],["fxFlex","50","matRipple","",1,"mat-elevation-z2","bg-foreground","text-center","p-6",3,"href","routerLink"],[1,"scale-150","mb-1"],["target","_blank","fxFlex","50","matRipple","",1,"mat-elevation-z2","bg-foreground","text-center","p-6",3,"href","routerLink"],[1,"scale-150"],[3,"config","routerLink"],["matBadgeOverlap","false","matBadgeColor","accent",3,"matBadge"]],template:function(e,t){1&e&&l["\u0275\u0275template"](0,q,23,25,"div",0),2&e&&l["\u0275\u0275property"]("ngIf",t.vm)},directives:[d.l,f.c,f.d,i.e,f.a,T.k,y.a,b.a,i.c,R.a],encapsulation:2,changeDetection:0}),e}();function H(e,t){1&e&&l["\u0275\u0275element"](0,"app-mission-details-view",1),2&e&&l["\u0275\u0275property"]("vm",t.$implicit)}var G=[{path:"",component:O,canActivate:[u.d],data:{page:c.a.MissionList},children:[{path:"ny",canActivate:[u.d],data:{preload:!0,allowedRoles:[c.i.Leder],page:c.a.MissionForm},loadChildren:function(){return n.e(4).then(n.bind(null,"4XuV")).then((function(e){return e.MissionFormModule}))}}]},{path:":id/detaljer",component:function(){function e(e,t,n,i,o,r,a,s,l){var u=this;this.mainNavService=e,this.missionService=t,this.missionImageService=n,this.missionDocumentService=i,this.missionNoteService=o,this.notificationService=r,this.route=a,this.router=s,this.dialog=l,this.RolePresets=c.h,this.Roles=c.i,this.uploadImages=function(e){u.missionImageService.addImages$(e.missionId,e.files).subscribe((function(e){return u.notificationService.setNotification("Vellykket! "+e.length+" "+(e.length>1?"bilder":"bilde")+" lastet opp.")}))},this.deleteMission=function(e){u.onBack(),u.missionService.delete$(e).pipe(Object(B.a)((function(e){return e}))).subscribe((function(e){return u.notificationService.setNotification("Vellykket! Oppdrag slettet.")}))},this.openMissionForm=function(e){return u.router.navigate(["rediger"],{relativeTo:u.route,queryParams:{idPreset:e}})},this.openDeleteMissionDialog=function(e){u.dialog.open(L.a,{data:"Bekreft at du \xf8nsker \xe5 slette oppdraget."}).afterClosed().pipe(Object(B.a)((function(e){return e}))).subscribe((function(t){return u.deleteMission(e)}))},this.goToTimesheets=function(e){return u.router.navigate(["timer/liste",{returnRoute:u.router.url,missionId:JSON.stringify(e)}])},this.onBack=function(){return u.router.navigate(["/oppdrag"])}}return e.prototype.ngOnInit=function(){var e=this,t=+this.route.snapshot.paramMap.get("id"),n=this.missionService.getDetails$(t),i=this.missionImageService.getByMissionId$(t).pipe(Object(s.a)((function(e){return e.length}))),r=this.missionDocumentService.getByMissionId$(t).pipe(Object(s.a)((function(e){return e.length}))),a=this.missionNoteService.getByMissionId$(t).pipe(Object(s.a)((function(e){return e.length})));this.vm$=Object(E.a)(n,i,r,a).pipe(Object(s.a)((function(e){var t=Object(o.c)(e,4);return{mission:t[0],imageCount:t[1],documentCount:t[2],noteCount:t[3]}})),Object(D.a)((function(t){return e.configureMainNav(t.mission)})))},e.prototype.configureMainNav=function(e){var t={title:e.address.split(",").filter((function(e){return"norge"!==e.toLowerCase().replace(/\s/g,"")})),subTitle:e.finished?"Oppdrag ferdig!":"",subIcon:e.finished?"check":"",imgSrc:e.imageURL,backFn:this.onBack};t.bottomSheetButtons=[{text:"Registrer timer",icon:"timer",callback:this.goToTimesheets,params:[e],allowedRoles:c.h.Internal},{text:"Rediger",icon:"edit",callback:this.openMissionForm,params:[e.id],allowedRoles:[c.i.Leder]},{text:"Slett",icon:"delete_forever",callback:this.openDeleteMissionDialog,params:[e.id],allowedRoles:[c.i.Leder]}],this.mainNavService.addTopNavConfig({detail:t})},e.\u0275fac=function(t){return new(t||e)(l["\u0275\u0275directiveInject"](u.p),l["\u0275\u0275directiveInject"](u.t),l["\u0275\u0275directiveInject"](u.r),l["\u0275\u0275directiveInject"](u.q),l["\u0275\u0275directiveInject"](u.s),l["\u0275\u0275directiveInject"](u.w),l["\u0275\u0275directiveInject"](i.a),l["\u0275\u0275directiveInject"](i.b),l["\u0275\u0275directiveInject"](p.b))},e.\u0275cmp=l["\u0275\u0275defineComponent"]({type:e,selectors:[["app-mission-details"]],decls:3,vars:3,consts:[[3,"vm",4,"ngIf"],[3,"vm"]],template:function(e,t){1&e&&(l["\u0275\u0275template"](0,H,1,1,"app-mission-details-view",0),l["\u0275\u0275pipe"](1,"async"),l["\u0275\u0275element"](2,"router-outlet")),2&e&&l["\u0275\u0275property"]("ngIf",l["\u0275\u0275pipeBind1"](1,1,t.vm$))},directives:[d.l,i.g,U],pipes:[d.b],encapsulation:2,changeDetection:0}),e}(),canActivate:[u.d],data:{page:c.a.MissionDetails},children:[{path:"rediger",canActivate:[u.d],data:{allowedRoles:[c.i.Leder]},loadChildren:function(){return n.e(4).then(n.bind(null,"4XuV")).then((function(e){return e.MissionFormModule}))}}]},{path:":id/bilder",loadChildren:function(){return Promise.all([n.e(0),n.e(21)]).then(n.bind(null,"skTp")).then((function(e){return e.MissionImageListModule}))},canActivate:[u.d],data:{preload:!0,page:c.a.MissionImages}},{path:":id/dokumenter",loadChildren:function(){return Promise.all([n.e(0),n.e(20)]).then(n.bind(null,"PvB8")).then((function(e){return e.MissionDocumentListModule}))},canActivate:[u.d],data:{preload:!0,page:c.a.MissionDocuments}},{path:":id/notater",loadChildren:function(){return n.e(23).then(n.bind(null,"QoWm")).then((function(e){return e.MissionNoteListModule}))},canActivate:[u.d],data:{preload:!0,page:c.a.MissionNotes}}],Q=function(){function e(){}return e.\u0275mod=l["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=l["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[i.f.forChild(G)],i.f]}),e}(),X=n("PCNd"),W=function(){function e(){}return e.\u0275mod=l["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=l["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},providers:[d.e],imports:[[X.a,Q]]}),e}()}}]);