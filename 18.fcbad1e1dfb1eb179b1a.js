(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{FCBk:function(e,t){},NFsL:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("HDdC"),o=n("LRne"),a=n("VUy1"),i=n("aIpU"),c=n("fXoL"),s=n("2ChS"),u=function(){function e(e){this.matBottomSheet=e}return e.prototype.open=function(e){return this.matBottomSheet.open(a.a,{data:{formConfig:e.formConfig,navConfig:e.navConfig,submitCallback:e.submitCallback,formComponent:i.a,formState$:e.formState instanceof r.a?e.formState:Object(o.a)(e.formState)}})},e.\u0275fac=function(t){return new(t||e)(c["\u0275\u0275inject"](s.b))},e.\u0275prov=c["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"any"}),e}()},sNHF:function(e,t,n){"use strict";var r=n("FCBk");n.o(r,"FormService")&&n.d(t,"FormService",(function(){return r.FormService}));var o=n("NFsL");n.d(t,"FormService",(function(){return o.a}))},zrcO:function(e,t,n){"use strict";n.r(t),n.d(t,"UsersModule",(function(){return se}));var r=n("mrSG"),o=n("9AJY"),a=n("XLlq"),i=n("PCNd"),c=n("K+RL"),s=n("9RCi"),u=n("lJxs"),p=n("G+73"),l=n("QNXn"),d=n("Gil/"),f="SAVE_USER",m=n("fXoL"),b=function(e){function t(){return e.call(this)||this}return Object(r.b)(t,e),t.prototype.handle$=function(t){var n=this;return t.pipe(Object(d.a)([f]),Object(u.a)((function(t){return{actionId:p.a,propagate:!0,request:e.prototype.createHttpRequest.call(n,t.action),stateSnapshot:t.stateSnapshot}})))},t.prototype.createHttpBody=function(e){return 2===e.saveAction?e.entity:Object(r.a)(Object(r.a)({},e.entity),{password:e.password})},t.\u0275prov=m["\u0275\u0275defineInjectable"]({token:t,factory:t.\u0275fac=function(e){return new(e||t)},providedIn:"root"}),t}(l.a),v=n("v/VQ"),y=Object(r.a)(Object(r.a)({},v.a),{actionId:f}),h="UPDATE_USER_PASSWORD",g=function(){function e(){}return e.prototype.handle$=function(e){return e.pipe(Object(d.a)([h]),Object(u.a)((function(e){return{actionId:p.a,propagate:!0,request:{apiUrl:"/Users/"+e.action.userName+"/NewPassword",method:"PUT",body:e.action},stateSnapshot:e.stateSnapshot}})))},e.\u0275prov=m["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac=function(t){return new(t||e)}}),e}(),w=n("tyNb"),j=n("1YJq"),O=n("eTJq"),S=n("wNVx"),I=n("3Pt+"),F=n("hIiN"),R=n("h7IN"),N=n("NE9p"),B=Object.keys(j.Roles).filter((function(e){return e!==j.Roles.Leder})).map((function(e){return j.Roles[e]})),C=Object(r.a)(Object(r.a)({},N.k),{required:!0,asyncStateValidators:[function(e){return t=e.pipe(Object(u.a)((function(e){var t;return null===(t=null==e?void 0:e.options)||void 0===t?void 0:t.users}))),function(e){return t.pipe(Object(u.a)((function(t){return t.find((function(t){return t.userName===e.value}))?{isunique:{value:e.value}}:null})))};var t}]}),k={name:"role",required:!0,type:"control",valueGetter:function(e){return null==e?void 0:e.role},questions:[{component:R.a,question:{placeholder:"Rolle",optionsGetter:function(e){return B}}}],validators:[I.q.maxLength(100)]},x={name:"password",required:!0,type:"control",questions:[{component:F.a,question:{placeholder:"Passord",hideable:!0,defaultHidden:!0}}],validators:[I.q.minLength(7),I.q.maxLength(100)]},q=Object(r.a)(Object(r.a)({},N.b),{questions:[Object(r.a)(Object(r.a)({},N.b.questions[0]),{hideOnValueChange:{controlName:"role",callback:function(e){return e!==j.Roles.Oppdragsgiver}}})]}),P={submitText:"Legg til",controls:[C,x,Object(r.a)(Object(r.a)({},N.c),{required:!0}),Object(r.a)(Object(r.a)({},N.g),{required:!0}),k,q,N.j,N.a]},L={submitText:"Oppdater",getRawValue:!0,disabledControls:{userName:!0},controls:[C,Object(r.a)(Object(r.a)({},N.c),{required:!0}),Object(r.a)(Object(r.a)({},N.g),{required:!0}),k,q,N.j,N.a]},U=function(e){function t(t){var n=e.call(this,t)||this;return n.actionId=f,n}return Object(r.b)(t,e),t.prototype.adapt=function(){var t=this.input.formState;t.role!==j.Roles.Oppdragsgiver&&(t.employerId=null),this.password=t.password,e.prototype.adapt.call(this)},t.prototype.convertFormStateToEntity=function(){delete this.input.formState.password,this.entity=this.input.formState},t}(n("1fZ0").a),E=n("Uejg"),T=n("sYIv"),V=function(){function e(e){var t=this;this.store=e,this.sortedUsers$=this.store.selectProperty$("users").pipe(Object(u.a)((function(e){return t.sortByRole(e)}))),this.sortByRole=function(e){var t,n;if(!e)return[];var o=Object(E.a)(e,"role"),a=[];try{for(var i=Object(r.e)(Object.keys(j.Roles).map((function(e){return j.Roles[e]}))),c=i.next();!c.done;c=i.next()){var s=c.value;o[s]&&(a=a.concat(o[s]))}}catch(u){t={error:u}}finally{try{c&&!c.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return a}}return Object.defineProperty(e.prototype,"users",{get:function(){return this.store.selectProperty("users")},enumerable:!1,configurable:!0}),e.prototype.updatePassword=function(e,t){console.log(e),this.store.dispatch({actionId:h,userName:e,newPassword:t})},e.\u0275fac=function(t){return new(t||e)(m["\u0275\u0275inject"](T.a))},e.\u0275prov=m["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"any"}),e}(),$=n("WAJ7"),J=n("sNHF"),X=n("tYFc"),A=n("ci80"),D=n("ofXK"),H=n("SRL/"),G=n("NFeN"),_=n("XiUz"),M=n("bTqV"),Y=n("4nE7");function z(e,t){if(1&e&&(m["\u0275\u0275elementStart"](0,"a",5),m["\u0275\u0275elementStart"](1,"mat-icon"),m["\u0275\u0275text"](2,"phone"),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"]()),2&e){var n=m["\u0275\u0275nextContext"]();m["\u0275\u0275propertyInterpolate1"]("href","tel:",n.user.phoneNumber,"",m["\u0275\u0275sanitizeUrl"])}}function K(e,t){if(1&e&&m["\u0275\u0275element"](0,"app-button",6),2&e){var n=m["\u0275\u0275nextContext"]();m["\u0275\u0275property"]("config",n.newPasswordButton)}}function Q(e,t){if(1&e&&m["\u0275\u0275element"](0,"app-button",6),2&e){var n=m["\u0275\u0275nextContext"]();m["\u0275\u0275property"]("config",n.editButton)}}var W=function(){function e(){this.Roles=j.Roles}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=m["\u0275\u0275defineComponent"]({type:e,selectors:[["app-user-card"]],inputs:{user:"user",editButton:"editButton",newPasswordButton:"newPasswordButton"},decls:8,vars:6,consts:[["rippleDisabled","true"],["left-side",""],["right-side","","fxLayout","row"],["style","color:green","mat-icon-button","",3,"href",4,"ngIf"],[3,"config",4,"ngIf"],["mat-icon-button","",2,"color","green",3,"href"],[3,"config"]],template:function(e,t){1&e&&(m["\u0275\u0275elementStart"](0,"app-list-card",0),m["\u0275\u0275elementStart"](1,"mat-icon",1),m["\u0275\u0275text"](2),m["\u0275\u0275elementEnd"](),m["\u0275\u0275text"](3),m["\u0275\u0275elementStart"](4,"span",2),m["\u0275\u0275template"](5,z,3,1,"a",3),m["\u0275\u0275template"](6,K,1,1,"app-button",4),m["\u0275\u0275template"](7,Q,1,1,"app-button",4),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"]()),2&e&&(m["\u0275\u0275advance"](2),m["\u0275\u0275textInterpolate"](t.user.role===t.Roles.Oppdragsgiver?"work":"person"),m["\u0275\u0275advance"](1),m["\u0275\u0275textInterpolate2"](" ",t.user.lastName,", ",t.user.firstName," "),m["\u0275\u0275advance"](2),m["\u0275\u0275property"]("ngIf",t.user.phoneNumber),m["\u0275\u0275advance"](1),m["\u0275\u0275property"]("ngIf",t.newPasswordButton&&t.user.role!=t.Roles.Leder),m["\u0275\u0275advance"](1),m["\u0275\u0275property"]("ngIf",t.editButton&&t.user.role!=t.Roles.Leder))},directives:[H.a,G.a,_.c,D.m,M.a,Y.a],encapsulation:2,changeDetection:0}),e}(),Z=n("Xa2L"),ee=function(e){return[e]},te=function(e,t,n,r){return{icon:"edit",allowedRoles:e,callback:t,params:n,type:r}},ne=function(e,t,n,r){return{icon:"vpn_key",color:"accent",allowedRoles:e,callback:t,params:n,type:r}};function re(e,t){if(1&e&&m["\u0275\u0275element"](0,"app-user-card",5),2&e){var n=t.$implicit,r=m["\u0275\u0275nextContext"](2);m["\u0275\u0275property"]("user",n)("editButton",m["\u0275\u0275pureFunction4"](7,te,m["\u0275\u0275pureFunction1"](3,ee,r.Roles.Leder),r.openUserForm,m["\u0275\u0275pureFunction1"](5,ee,n.userName),r.ButtonTypes.Icon))("newPasswordButton",m["\u0275\u0275pureFunction4"](16,ne,m["\u0275\u0275pureFunction1"](12,ee,r.Roles.Leder),r.openNewPasswordForm,m["\u0275\u0275pureFunction1"](14,ee,n.userName),r.ButtonTypes.Icon))}}function oe(e,t){if(1&e&&(m["\u0275\u0275elementStart"](0,"div",3),m["\u0275\u0275template"](1,re,1,21,"app-user-card",4),m["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit,r=m["\u0275\u0275nextContext"]();m["\u0275\u0275advance"](1),m["\u0275\u0275property"]("ngForOf",n)("ngForTrackBy",r.trackByUser)}}function ae(e,t){1&e&&m["\u0275\u0275element"](0,"mat-spinner",6)}var ie=[{path:"",component:function(){function e(e,t,n){var o=this;this.facade=e,this.modelFormService=t,this.formService=n,this.Roles=j.Roles,this.ButtonTypes=j.ButtonTypes,this.users$=this.facade.sortedUsers$,this.openUserForm=function(e){o.modelFormService.open({formConfig:{entityId:e,stateProp:"users",dynamicForm:e?L:P,adapter:U}})},this.openNewPasswordForm=function(e){o.formService.open({formConfig:Object(r.a)(Object(r.a)({},S.b),{initialValue:{userName:e}}),navConfig:{title:"Oppdater passord"},submitCallback:function(e){return o.facade.updatePassword(e.userName,e.newPassword)}})},this.trackByUser=Object(O.a)("users"),this.navConfig={title:"Brukere",buttons:[{icon:"person_add",aria:"Ny bruker",callback:this.openUserForm,allowedRoles:[j.Roles.Leder]}]}}return e.\u0275fac=function(t){return new(t||e)(m["\u0275\u0275directiveInject"](V),m["\u0275\u0275directiveInject"]($.ModelFormService),m["\u0275\u0275directiveInject"](J.FormService))},e.\u0275cmp=m["\u0275\u0275defineComponent"]({type:e,selectors:[["app-user-list"]],decls:6,vars:5,consts:[["navbar","",3,"config"],["class","pl-1 pr-1 pb-1 max-width",4,"ngIf","ngIfElse"],["loading",""],[1,"pl-1","pr-1","pb-1","max-width"],[3,"user","editButton","newPasswordButton",4,"ngFor","ngForOf","ngForTrackBy"],[3,"user","editButton","newPasswordButton"],["color","accent",1,"center-spinner"]],template:function(e,t){if(1&e&&(m["\u0275\u0275elementStart"](0,"app-main-skeleton"),m["\u0275\u0275element"](1,"app-main-top-nav-bar",0),m["\u0275\u0275template"](2,oe,2,2,"div",1),m["\u0275\u0275pipe"](3,"async"),m["\u0275\u0275elementEnd"](),m["\u0275\u0275template"](4,ae,1,0,"ng-template",null,2,m["\u0275\u0275templateRefExtractor"])),2&e){var n=m["\u0275\u0275reference"](5);m["\u0275\u0275advance"](1),m["\u0275\u0275property"]("config",t.navConfig),m["\u0275\u0275advance"](1),m["\u0275\u0275property"]("ngIf",m["\u0275\u0275pipeBind1"](3,3,t.users$))("ngIfElse",n)}},directives:[X.a,A.a,D.m,D.l,W,Z.b],pipes:[D.b],encapsulation:2,changeDetection:0}),e}()}],ce=function(){function e(){}return e.\u0275mod=m["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=m["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[w.f.forChild(ie)],w.f]}),e}(),se=function(){function e(){}return e.\u0275mod=m["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=m["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},providers:Object(r.d)(o.a,[{provide:c.b,useClass:g,multi:!0},{provide:c.b,useClass:b,multi:!0},{provide:c.c,useValue:y,multi:!0}]),imports:[[i.a,s.a,a.a,ce]]}),e}()}}]);
//# sourceMappingURL=18.fcbad1e1dfb1eb179b1a.js.map