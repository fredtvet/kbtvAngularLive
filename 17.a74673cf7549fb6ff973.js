(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{zrcO:function(e,t,r){"use strict";r.r(t),r.d(t,"UsersModule",(function(){return Z}));var n=r("PCNd"),i=r("DUip"),o=r("dJ3e"),a=r("mrSG"),s=r("k5Aa"),l=r("67Y/"),u=r("h/AT"),m=r("1ua0"),p=r("VnD/"),c=r("TYT/"),f=r("ea4N"),d=r("9tSM"),h=r("QJY3"),v=r("Valr"),g=r("uLXW"),y=r("eHTH"),b=r("cSbt"),S=r("agxM"),I=r("qaSM"),N=r("p+mS"),x=r("Up+3"),w=r("GsDI"),E=r("MqYC");function k(e,t){1&e&&(c["\u0275\u0275elementStart"](0,"mat-error"),c["\u0275\u0275text"](1," Minst 4 tegn. \xc6\xd8\xc5 og mellomrom ikke tillatt. "),c["\u0275\u0275elementEnd"]())}function C(e,t){1&e&&(c["\u0275\u0275elementStart"](0,"mat-error"),c["\u0275\u0275text"](1," Passord er ett obligatorisk felt p\xe5 minst 7 tegn. "),c["\u0275\u0275elementEnd"]())}function F(e,t){if(1&e){var r=c["\u0275\u0275getCurrentView"]();c["\u0275\u0275elementStart"](0,"mat-form-field"),c["\u0275\u0275element"](1,"input",12),c["\u0275\u0275elementStart"](2,"mat-icon",13),c["\u0275\u0275listener"]("click",(function(){c["\u0275\u0275restoreView"](r);var e=c["\u0275\u0275nextContext"](2);return e.hidePassword=!e.hidePassword})),c["\u0275\u0275text"](3),c["\u0275\u0275elementEnd"](),c["\u0275\u0275template"](4,C,2,0,"mat-error",3),c["\u0275\u0275elementEnd"]()}if(2&e){var n=c["\u0275\u0275nextContext"](2);c["\u0275\u0275advance"](1),c["\u0275\u0275property"]("type",n.hidePassword?"password":"text"),c["\u0275\u0275advance"](2),c["\u0275\u0275textInterpolate1"](" ",n.hidePassword?"visibility_off":"visibility"," "),c["\u0275\u0275advance"](1),c["\u0275\u0275property"]("ngIf",n.password.invalid)}}function O(e,t){1&e&&(c["\u0275\u0275elementStart"](0,"mat-error"),c["\u0275\u0275text"](1," Fornavn er ett obligatorisk felt p\xe5 maks 100 tegn. "),c["\u0275\u0275elementEnd"]())}function j(e,t){1&e&&(c["\u0275\u0275elementStart"](0,"mat-error"),c["\u0275\u0275text"](1," Etternavn er ett obligatorisk felt p\xe5 maks 100 tegn. "),c["\u0275\u0275elementEnd"]())}function P(e,t){if(1&e&&(c["\u0275\u0275elementStart"](0,"mat-option",14),c["\u0275\u0275text"](1),c["\u0275\u0275elementEnd"]()),2&e){var r=t.$implicit;c["\u0275\u0275property"]("value",r),c["\u0275\u0275advance"](1),c["\u0275\u0275textInterpolate"](r)}}function B(e,t){if(1&e&&(c["\u0275\u0275elementStart"](0,"mat-option",14),c["\u0275\u0275text"](1),c["\u0275\u0275elementEnd"]()),2&e){var r=t.$implicit;c["\u0275\u0275property"]("value",r.id),c["\u0275\u0275advance"](1),c["\u0275\u0275textInterpolate"](r.name)}}function L(e,t){1&e&&(c["\u0275\u0275elementStart"](0,"mat-error"),c["\u0275\u0275text"](1," Kontaktnummer m\xe5 v\xe6re mellom 4 og 12 siffer. "),c["\u0275\u0275elementEnd"]())}function R(e,t){if(1&e){var r=c["\u0275\u0275getCurrentView"]();c["\u0275\u0275elementStart"](0,"form",1),c["\u0275\u0275elementStart"](1,"mat-form-field"),c["\u0275\u0275element"](2,"input",2),c["\u0275\u0275template"](3,k,2,0,"mat-error",3),c["\u0275\u0275elementEnd"](),c["\u0275\u0275template"](4,F,5,3,"mat-form-field",3),c["\u0275\u0275elementStart"](5,"mat-form-field"),c["\u0275\u0275element"](6,"input",4),c["\u0275\u0275template"](7,O,2,0,"mat-error",3),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](8,"mat-form-field"),c["\u0275\u0275element"](9,"input",5),c["\u0275\u0275template"](10,j,2,0,"mat-error",3),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](11,"mat-form-field"),c["\u0275\u0275elementStart"](12,"mat-select",6),c["\u0275\u0275listener"]("change",(function(e){return c["\u0275\u0275restoreView"](r),c["\u0275\u0275nextContext"]().changeRole(e)})),c["\u0275\u0275template"](13,P,2,2,"mat-option",7),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](14,"mat-form-field",8),c["\u0275\u0275elementStart"](15,"mat-select",9),c["\u0275\u0275listener"]("change",(function(e){return c["\u0275\u0275restoreView"](r),c["\u0275\u0275nextContext"]().changeEmployerId(e)})),c["\u0275\u0275template"](16,B,2,2,"mat-option",7),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](17,"mat-form-field"),c["\u0275\u0275element"](18,"input",10),c["\u0275\u0275template"](19,L,2,0,"mat-error",3),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](20,"button",11),c["\u0275\u0275listener"]("click",(function(){return c["\u0275\u0275restoreView"](r),c["\u0275\u0275nextContext"]().onSubmit()})),c["\u0275\u0275text"](21),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"]()}if(2&e){var n=c["\u0275\u0275nextContext"]();c["\u0275\u0275property"]("formGroup",n.userForm),c["\u0275\u0275advance"](3),c["\u0275\u0275property"]("ngIf",n.userName.invalid),c["\u0275\u0275advance"](1),c["\u0275\u0275property"]("ngIf",n.isCreateForm),c["\u0275\u0275advance"](3),c["\u0275\u0275property"]("ngIf",n.firstName.invalid),c["\u0275\u0275advance"](3),c["\u0275\u0275property"]("ngIf",n.lastName.invalid),c["\u0275\u0275advance"](3),c["\u0275\u0275property"]("ngForOf",n.roles),c["\u0275\u0275advance"](1),c["\u0275\u0275property"]("fxHide",n.role.value!==n.Roles.Oppdragsgiver),c["\u0275\u0275advance"](2),c["\u0275\u0275property"]("ngForOf",n.employers),c["\u0275\u0275advance"](3),c["\u0275\u0275property"]("ngIf",n.phoneNumber.invalid),c["\u0275\u0275advance"](1),c["\u0275\u0275property"]("disabled",n.userForm.invalid||n.userForm.pristine),c["\u0275\u0275advance"](1),c["\u0275\u0275textInterpolate1"](" ",n.isCreateForm?"Legg til":"Oppdater"," ")}}var $=function(){function e(e){this._formBuilder=e,this.Roles=s.f,this.formSubmitted=new c.EventEmitter,this.isCreateForm=!1,this.hidePassword=!0}return e.prototype.ngOnInit=function(){this.user&&!this.user.userName||(this.isCreateForm=!0),this.initalizeForm(this.user)},e.prototype.initalizeForm=function(e){this.userForm=this._formBuilder.group({userName:[{value:e?e.userName:null,disabled:!this.isCreateForm},[h.s.required,h.s.pattern("^[a-zA-Z0-9_.-]*$"),h.s.minLength(4),h.s.maxLength(100)]],password:[{value:null,disabled:!this.isCreateForm},[h.s.required,h.s.minLength(7),h.s.maxLength(100)]],firstName:[e?e.firstName:null,[h.s.required,h.s.maxLength(100)]],lastName:[e?e.lastName:null,[h.s.required,h.s.maxLength(100)]],phoneNumber:[e?e.phoneNumber:null,[h.s.minLength(4),h.s.maxLength(12)]],role:[e?e.role:null,[h.s.required]],employerId:[e?e.employerId:null]})},e.prototype.onSubmit=function(){this.userForm.valid&&this.userForm.dirty&&this.formSubmitted.emit(this.userForm.getRawValue())},e.prototype.changeRole=function(e){this.role.setValue(e.target.value,{onlySelf:!0})},e.prototype.changeEmployerId=function(e){this.employerId.setValue(e.target.value,{onlySelf:!0})},Object.defineProperty(e.prototype,"userName",{get:function(){return this.userForm.get("userName")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"password",{get:function(){return this.userForm.get("password")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firstName",{get:function(){return this.userForm.get("firstName")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lastName",{get:function(){return this.userForm.get("lastName")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"phoneNumber",{get:function(){return this.userForm.get("phoneNumber")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"role",{get:function(){return this.userForm.get("role")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"employerId",{get:function(){return this.userForm.get("employerId")},enumerable:!0,configurable:!0}),e.\u0275fac=function(t){return new(t||e)(c["\u0275\u0275directiveInject"](h.c))},e.\u0275cmp=c["\u0275\u0275defineComponent"]({type:e,selectors:[["app-user-form-view"]],inputs:{user:"user",employers:"employers",roles:"roles"},outputs:{formSubmitted:"formSubmitted"},decls:1,vars:1,consts:[["fxLayout","column",3,"formGroup",4,"ngIf"],["fxLayout","column",3,"formGroup"],["matInput","","placeholder","Brukernavn","formControlName","userName","required",""],[4,"ngIf"],["matInput","","placeholder","Fornavn","formControlName","firstName","required",""],["matInput","","placeholder","Etternavn","formControlName","lastName","required",""],["placeholder","Rolle","formControlName","role","required","",3,"change"],[3,"value",4,"ngFor","ngForOf"],[3,"fxHide"],["placeholder","Oppdragsgiver","formControlName","employerId",3,"change"],["matInput","","placeholder","Kontaktnummer","formControlName","phoneNumber"],["appHttpCommandButton","","mat-raised-button","","color","primary",1,"w-100",3,"disabled","click"],["matInput","","placeholder","Passord","formControlName","password","required","",3,"type"],["matSuffix","",3,"click"],[3,"value"]],template:function(e,t){1&e&&c["\u0275\u0275template"](0,R,22,11,"form",0),2&e&&c["\u0275\u0275property"]("ngIf",t.userForm)},directives:[v.l,h.t,h.m,g.c,h.e,y.c,b.a,h.b,h.l,h.d,h.r,S.a,v.k,I.b,N.b,x.a,y.b,w.a,y.h,E.k],encapsulation:2,changeDetection:0}),e}(),_=function(){function e(e,t,r,n){this.notificationService=e,this._roleService=t,this._userService=r,this._employerService=n,this.Roles=s.f,this.finished=new c.EventEmitter,this.isCreateForm=!1}return e.prototype.ngOnInit=function(){this.userNamePreset?this.user$=this._userService.get$(this.userNamePreset):this.isCreateForm=!0,this.roles$=this._roleService.getAll$().pipe(Object(l.a)((function(e){return e.filter((function(e){return e!=s.f.Leder}))}))),this.employers$=this._employerService.getAll$()},e.prototype.onSubmit=function(e){e?this.isCreateForm?this.createUser(e):this.updateUser(e):this.finished.emit()},e.prototype.createUser=function(e){var t=this;this._userService.add$(e).subscribe((function(e){t.notificationService.setNotification("Vellykket! Ny bruker registrert."),t.finished.emit(e)}))},e.prototype.updateUser=function(e){var t=this;this._userService.update$(e).subscribe((function(e){t.notificationService.setNotification("Vellykket oppdatering!"),t.finished.emit(e)}))},e.\u0275fac=function(t){return new(t||e)(c["\u0275\u0275directiveInject"](o.v),c["\u0275\u0275directiveInject"](o.w),c["\u0275\u0275directiveInject"](o.A),c["\u0275\u0275directiveInject"](o.k))},e.\u0275cmp=c["\u0275\u0275defineComponent"]({type:e,selectors:[["app-user-form"]],inputs:{userNamePreset:"userNamePreset"},outputs:{finished:"finished"},decls:4,vars:9,consts:[[3,"user","roles","employers","formSubmitted"]],template:function(e,t){1&e&&(c["\u0275\u0275elementStart"](0,"app-user-form-view",0),c["\u0275\u0275listener"]("formSubmitted",(function(e){return t.onSubmit(e)})),c["\u0275\u0275pipe"](1,"async"),c["\u0275\u0275pipe"](2,"async"),c["\u0275\u0275pipe"](3,"async"),c["\u0275\u0275elementEnd"]()),2&e&&c["\u0275\u0275property"]("user",c["\u0275\u0275pipeBind1"](1,3,t.user$))("roles",c["\u0275\u0275pipeBind1"](2,5,t.roles$))("employers",c["\u0275\u0275pipeBind1"](3,7,t.employers$))},directives:[$],pipes:[v.b],encapsulation:2,changeDetection:0}),e}(),A=function(){function e(e,t,r,n){var i=this;this._userService=e,this._dialog=t,this._bottomSheetRef=r,this.data=n,this.close=function(){return i._bottomSheetRef.dismiss()},this.confirmDelete=function(){i._dialog.open(m.a,{data:"Bekreft at du \xf8nsker \xe5 slette oppdragsgiveren fra systemet."}).afterClosed().pipe(Object(p.a)((function(e){return e}))).subscribe((function(e){return i.deleteEmployer()}))},this.deleteEmployer=function(){return i._userService.delete$(i.data.userNamePreset).subscribe((function(e){return i.close()}))}}return e.prototype.ngOnInit=function(){var e=!this.data||!this.data.userNamePreset;this.navConfig={title:e?"Registrer bruker":"Rediger bruker",leftBtn:{icon:"close",callback:this.close},buttons:e?void 0:[{icon:"delete_forever",callback:this.confirmDelete}]}},e.\u0275fac=function(t){return new(t||e)(c["\u0275\u0275directiveInject"](o.A),c["\u0275\u0275directiveInject"](f.b),c["\u0275\u0275directiveInject"](u.d),c["\u0275\u0275directiveInject"](u.a))},e.\u0275cmp=c["\u0275\u0275defineComponent"]({type:e,selectors:[["app-user-form-sheet-wrapper"]],decls:2,vars:2,consts:[[3,"config"],[3,"userNamePreset","finished"]],template:function(e,t){1&e&&(c["\u0275\u0275elementStart"](0,"app-simple-top-nav",0),c["\u0275\u0275elementStart"](1,"app-user-form",1),c["\u0275\u0275listener"]("finished",(function(){return t.close()})),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"]()),2&e&&(c["\u0275\u0275property"]("config",t.navConfig),c["\u0275\u0275advance"](1),c["\u0275\u0275property"]("userNamePreset",null==t.data?null:t.data.userNamePreset))},directives:[d.a,_],encapsulation:2,changeDetection:0}),e}(),M=r("17Os"),V=r("TaW2"),q=function(){function e(e){this.employerService=e,this.result=null}return e.prototype.transform=function(e){var t=this;if(e&&null!=e)return this.sub=this.employerService.get$(e).subscribe((function(e){return t.result=e})),this.result},e.prototype.ngOnDestroy=function(){this.sub&&this.sub.unsubscribe()},e.\u0275fac=function(t){return new(t||e)(c["\u0275\u0275directiveInject"](o.k))},e.\u0275pipe=c["\u0275\u0275definePipe"]({name:"getEmployerById",type:e,pure:!1}),e}();function D(e,t){if(1&e&&(c["\u0275\u0275elementStart"](0,"mat-hint"),c["\u0275\u0275text"](1),c["\u0275\u0275elementEnd"]()),2&e){var r=t.$implicit;c["\u0275\u0275advance"](1),c["\u0275\u0275textInterpolate"](r.name)}}function U(e,t){if(1&e&&(c["\u0275\u0275elementStart"](0,"a",8),c["\u0275\u0275elementStart"](1,"mat-icon"),c["\u0275\u0275text"](2,"phone"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"]()),2&e){var r=c["\u0275\u0275nextContext"]();c["\u0275\u0275propertyInterpolate1"]("href","tel:",r.user.phoneNumber,"",c["\u0275\u0275sanitizeUrl"])}}function T(e,t){if(1&e&&c["\u0275\u0275element"](0,"app-icon-button",9),2&e){var r=c["\u0275\u0275nextContext"]();c["\u0275\u0275property"]("config",r.editButton)}}var z=function(){function e(){this.Roles=s.f}return e.prototype.ngOnInit=function(){},e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=c["\u0275\u0275defineComponent"]({type:e,selectors:[["app-user-card"]],inputs:{user:"user",editButton:"editButton"},decls:13,vars:8,consts:[[1,"app-card","mb-1"],["fxLayout","row","fxLayoutAlign","space-between center"],[1,"mr-2"],[1,"ellipsis","mr-auto"],[1,"mat-h4"],[4,"ngIf"],["class","color-success","mat-icon-button","",3,"href",4,"ngIf"],[3,"config",4,"ngIf"],["mat-icon-button","",1,"color-success",3,"href"],[3,"config"]],template:function(e,t){1&e&&(c["\u0275\u0275elementStart"](0,"mat-card",0),c["\u0275\u0275elementStart"](1,"mat-card-content",1),c["\u0275\u0275elementStart"](2,"mat-icon",2),c["\u0275\u0275text"](3),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](4,"span",3),c["\u0275\u0275elementStart"](5,"span",4),c["\u0275\u0275text"](6),c["\u0275\u0275elementEnd"](),c["\u0275\u0275element"](7,"br"),c["\u0275\u0275template"](8,D,2,1,"mat-hint",5),c["\u0275\u0275pipe"](9,"getEmployerById"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](10,"span"),c["\u0275\u0275template"](11,U,3,1,"a",6),c["\u0275\u0275template"](12,T,1,1,"app-icon-button",7),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"]()),2&e&&(c["\u0275\u0275advance"](3),c["\u0275\u0275textInterpolate"](t.user.role==t.Roles.Oppdragsgiver?"work":"person"),c["\u0275\u0275advance"](3),c["\u0275\u0275textInterpolate2"]("",t.user.firstName," ",t.user.lastName,""),c["\u0275\u0275advance"](2),c["\u0275\u0275property"]("ngIf",c["\u0275\u0275pipeBind1"](9,6,t.user.employerId)),c["\u0275\u0275advance"](3),c["\u0275\u0275property"]("ngIf",t.user.phoneNumber),c["\u0275\u0275advance"](1),c["\u0275\u0275property"]("ngIf",t.editButton&&t.user.role!=t.Roles.Leder))},directives:[M.a,M.b,g.c,g.b,w.a,v.l,y.f,N.a,V.a],pipes:[q],encapsulation:2,changeDetection:0}),e}(),G=r("uad8"),H=function(e){return[e]},J=function(e,t,r){return{icon:"edit",allowedRoles:e,callback:t,params:r}};function Y(e,t){if(1&e&&c["\u0275\u0275element"](0,"app-user-card",4),2&e){var r=t.$implicit,n=c["\u0275\u0275nextContext"](2);c["\u0275\u0275property"]("user",r)("editButton",c["\u0275\u0275pureFunction3"](6,J,c["\u0275\u0275pureFunction1"](2,H,n.Roles.Leder),n.openUserForm,c["\u0275\u0275pureFunction1"](4,H,r.userName)))}}function K(e,t){if(1&e&&(c["\u0275\u0275elementStart"](0,"div",2),c["\u0275\u0275template"](1,Y,1,10,"app-user-card",3),c["\u0275\u0275elementEnd"]()),2&e){var r=t.$implicit;c["\u0275\u0275advance"](1),c["\u0275\u0275property"]("ngForOf",r)}}function W(e,t){1&e&&c["\u0275\u0275element"](0,"mat-spinner",5)}var Q=[{path:"",component:function(){function e(e,t,r){var n=this;this.mainNavService=e,this.userService=t,this._bottomSheet=r,this.Roles=s.f,this.users$=this.userService.getAll$().pipe(Object(l.a)(this.sortByRole)),this.openUserForm=function(e){return n._bottomSheet.open(A,{data:{userNamePreset:e}})},this.configureMainNav()}return e.prototype.configureMainNav=function(){var e={title:"Brukere"};e.buttons=[{icon:"person_add",colorClass:"color-accent",aria:"Ny bruker",callback:this.openUserForm,allowedRoles:[s.f.Leder]}],this.mainNavService.addTopNavConfig({default:e})},e.prototype.sortByRole=function(e){var t=e.reduce((function(e,t){switch(t.role){case s.f.Leder:e[s.f.Leder].push(t);break;case s.f.Mellomleder:e[s.f.Mellomleder].push(t);break;case s.f.Ansatt:e[s.f.Ansatt].push(t);break;case s.f.Oppdragsgiver:e[s.f.Oppdragsgiver].push(t)}return e}),{Leder:[],Mellomleder:[],Ansatt:[],Oppdragsgiver:[]});return Object(a.d)(t[s.f.Leder],t[s.f.Mellomleder],t[s.f.Ansatt],t[s.f.Oppdragsgiver])},e.\u0275fac=function(t){return new(t||e)(c["\u0275\u0275directiveInject"](o.o),c["\u0275\u0275directiveInject"](o.A),c["\u0275\u0275directiveInject"](u.b))},e.\u0275cmp=c["\u0275\u0275defineComponent"]({type:e,selectors:[["app-user-list"]],decls:4,vars:4,consts:[["class","p-2 max-width",4,"ngIf","ngIfElse"],["loading",""],[1,"p-2","max-width"],[3,"user","editButton",4,"ngFor","ngForOf"],[3,"user","editButton"],["color","accent",1,"center-spinner"]],template:function(e,t){if(1&e&&(c["\u0275\u0275template"](0,K,2,1,"div",0),c["\u0275\u0275pipe"](1,"async"),c["\u0275\u0275template"](2,W,1,0,"ng-template",null,1,c["\u0275\u0275templateRefExtractor"])),2&e){var r=c["\u0275\u0275reference"](3);c["\u0275\u0275property"]("ngIf",c["\u0275\u0275pipeBind1"](1,2,t.users$))("ngIfElse",r)}},directives:[v.l,v.k,z,G.b],pipes:[v.b],encapsulation:2,changeDetection:0}),e}(),canActivate:[o.d],data:{allowedRoles:[s.f.Leder,s.f.Mellomleder]}}],X=function(){function e(){}return e.\u0275mod=c["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=c["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[i.f.forChild(Q)],i.f]}),e}(),Z=function(){function e(){}return e.\u0275mod=c["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=c["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[n.a,X]]}),e}()}}]);