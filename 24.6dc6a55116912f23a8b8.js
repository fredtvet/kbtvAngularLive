(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{BPJZ:function(e,t,i){"use strict";i.r(t),i.d(t,"UserTimesheetWeekModule",(function(){return ge}));var n=i("mrSG"),r=i("Ocsb"),a=i("tyNb"),o=i("itXk"),c=i("lJxs"),s=i("kDc5"),l=i("oX2G"),p=i("sVak"),u=i("0Afw"),m=i("sWmp"),d=i("orwI"),f=i("0IaG"),h=i("Ko4u"),v=i("fXoL"),k=i("sYIv"),C=i("+1Be"),w=i("ofXK"),g=function(){function e(e,t){var i=this;this.store=e,this.timesheetId=t,this.timesheet$=this.store.select$(["userTimesheets","missions"],!1).pipe(Object(c.a)((function(e){var t=Object(h.a)(e.userTimesheets,i.timesheetId,"id");return t?(t.mission=Object(h.a)(e.missions,t.missionId,"id"),t):null})))}return e.\u0275fac=function(t){return new(t||e)(v["\u0275\u0275directiveInject"](k.a),v["\u0275\u0275directiveInject"](f.a))},e.\u0275cmp=v["\u0275\u0275defineComponent"]({type:e,selectors:[["app-timesheet-card-dialog-wrapper"]],decls:2,vars:3,consts:[[3,"timesheet"]],template:function(e,t){1&e&&(v["\u0275\u0275element"](0,"app-timesheet-card",0),v["\u0275\u0275pipe"](1,"async")),2&e&&v["\u0275\u0275property"]("timesheet",v["\u0275\u0275pipeBind1"](1,1,t.timesheet$))},directives:[C.a],pipes:[w.b],encapsulation:2,changeDetection:0}),e}(),y=i("hoV1"),b=i("K+RL"),j=i("m/Bn"),x=i("lyac");function I(e){var t=new Date(e,0,1),i=1===new Date(e,1,29).getMonth();return 4===t.getDay()||i&&3===t.getDay()?53:52}var S="SET_TIMESHEET_CRITERIA",O={actionId:S,reducerFn:function(e,t){return{timesheetCriteria:new x.a(t.weekCriteria),weekCriteria:t.weekCriteria}}},D="NEXT_WEEK",E={actionId:D,stateProperties:["weekCriteria"],reducerFn:function(e,t){if(!(e.weekCriteria.year>=t.currYear&&e.weekCriteria.weekNr>=t.currWeekNr))return e.weekCriteria.weekNr>=I(e.weekCriteria.year)?(e.weekCriteria.year++,e.weekCriteria.weekNr=1):e.weekCriteria.weekNr++,{timesheetCriteria:new x.a(e.weekCriteria),weekCriteria:e.weekCriteria}}},T="PREVIOUS_WEEK",F={actionId:T,stateProperties:["weekCriteria"],reducerFn:function(e,t){var i=e.weekCriteria;return i.weekNr<=1?(i.year--,i.weekNr=I(i.year)):i.weekNr--,{timesheetCriteria:new x.a(i),weekCriteria:i}}},N=i("t7j9"),B=i("NlAt"),$=i("k5Aa"),W=i("RuLz"),L=i("DHoI"),P=i("iI2U"),V=i("lvqV"),A=function(){function e(e,t,i){var r=this;this.summaryAggregator=e,this.store=t,this.componentStore=i,this.currentWeekNr=Object(y.a)(),this.currentYear=(new Date).getFullYear(),this.weekCriteria$=this.componentStore.selectProperty$("weekCriteria"),this.filteredTimesheets$=Object(o.a)([this.store.selectProperty$("userTimesheets"),this.componentStore.selectProperty$("timesheetCriteria")]).pipe(Object(W.a)(L.a),Object(c.a)((function(e){return e.records}))),this.weekDaySummaries$=Object(o.a)([this.filteredTimesheets$,this.store.selectProperty$("missions")]).pipe(Object(c.a)((function(e){var t=Object(n.c)(e,2),i=t[0],a=t[1],o=new B.a("userTimesheets",null,["missions"]),c=Object(N.a)({userTimesheets:i,missions:a},o);return function(e,t){if(e){for(var i={},n=0;n<e.length;n++){var r=e[n];i[new Date(r.date).getDay()||7]=r}return i}}(r.summaryAggregator.groupByType($.a.Day,c))}))),this.previousWeek=function(){return r.componentStore.dispatch({actionId:T})},this.nextWeek=function(){return r.componentStore.dispatch({actionId:D,currYear:r.currentYear,currWeekNr:r.currentWeekNr})},this.updateCriteria=function(e){return r.componentStore.dispatch({actionId:S,weekCriteria:e})}}return Object.defineProperty(e.prototype,"weekCriteria",{get:function(){return this.componentStore.selectProperty("weekCriteria")},enumerable:!1,configurable:!0}),e.\u0275fac=function(t){return new(t||e)(v["\u0275\u0275inject"](P.a),v["\u0275\u0275inject"](k.a),v["\u0275\u0275inject"](V.a))},e.\u0275prov=v["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac}),e}(),M={year:(new Date).getFullYear(),weekNr:Object(y.a)()},Y={weekCriteria:M,timesheetCriteria:new x.a(M)},R=Object(n.d)(j.a,[A,{provide:b.c,useValue:O,multi:!0},{provide:b.c,useValue:E,multi:!0},{provide:b.c,useValue:F,multi:!0},{provide:b.a,useValue:Y}]),X=i("/bry"),J=i("WAJ7"),z=i("sNHF"),H=i("tYFc"),K=i("ci80"),U=i("eTJq"),_=i("XiUz"),G=i("FKr1"),q=i("znSr"),Q=i("NFeN"),Z=function(){function e(){}return e.prototype.transform=function(e){var t=new Date,i=new Date(e);return i.getDate()===t.getDate()&&i.getMonth()===t.getMonth()&&i.getFullYear()===t.getFullYear()},e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=v["\u0275\u0275definePipe"]({name:"isToday",type:e,pure:!0}),e}();function ee(e,t){if(1&e&&(v["\u0275\u0275elementStart"](0,"div",3),v["\u0275\u0275elementStart"](1,"span",4),v["\u0275\u0275text"](2),v["\u0275\u0275pipe"](3,"date"),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](4,"span",5),v["\u0275\u0275text"](5),v["\u0275\u0275pipe"](6,"date"),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](7,"span",6),v["\u0275\u0275text"](8),v["\u0275\u0275pipe"](9,"date"),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"]()),2&e){var i=v["\u0275\u0275nextContext"]();v["\u0275\u0275advance"](2),v["\u0275\u0275textInterpolate1"](" ",v["\u0275\u0275pipeBind2"](3,3,i.date,"E")," "),v["\u0275\u0275advance"](3),v["\u0275\u0275textInterpolate1"](" ",v["\u0275\u0275pipeBind2"](6,6,i.date,"dd")," "),v["\u0275\u0275advance"](3),v["\u0275\u0275textInterpolate1"](" ",v["\u0275\u0275pipeBind2"](9,9,i.date,"MMM")," ")}}var te=function(){function e(e){this.dialog=e,this.labelClicked=new v.EventEmitter}return e.\u0275fac=function(t){return new(t||e)(v["\u0275\u0275directiveInject"](f.b))},e.\u0275cmp=v["\u0275\u0275defineComponent"]({type:e,selectors:[["app-timesheet-day-label"]],inputs:{date:"date"},outputs:{labelClicked:"labelClicked"},decls:5,vars:4,consts:[["fxLayout","column","fxLayoutAlign","start center","matRipple","",1,"mat-elevation-z2","pt-2",3,"ngClass","click"],["fxLayout","column","fxLayoutAlign","center center",4,"ngIf"],[1,"icon","m-1"],["fxLayout","column","fxLayoutAlign","center center"],[1,"mat-h3","m-0","line-height-100"],[1,"mat-title","m-0","line-height-100"],[1,"mat-small","line-height-100"]],template:function(e,t){1&e&&(v["\u0275\u0275elementStart"](0,"span",0),v["\u0275\u0275listener"]("click",(function(){return t.labelClicked.emit(t.date.getTime())})),v["\u0275\u0275pipe"](1,"isToday"),v["\u0275\u0275template"](2,ee,10,12,"div",1),v["\u0275\u0275elementStart"](3,"mat-icon",2),v["\u0275\u0275text"](4,"add"),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"]()),2&e&&(v["\u0275\u0275property"]("ngClass",v["\u0275\u0275pipeBind1"](1,2,t.date)?"accent":"foreground-card color-accent"),v["\u0275\u0275advance"](2),v["\u0275\u0275property"]("ngIf",t.date))},directives:[_.c,_.b,G.l,w.k,q.a,w.m,Q.a],pipes:[Z,w.e],encapsulation:2,changeDetection:0}),e}();function ie(e,t){if(1&e){var i=v["\u0275\u0275getCurrentView"]();v["\u0275\u0275elementContainerStart"](0),v["\u0275\u0275elementStart"](1,"div",1),v["\u0275\u0275listener"]("click",(function(){return v["\u0275\u0275restoreView"](i),v["\u0275\u0275nextContext"]().clickBar()})),v["\u0275\u0275elementStart"](2,"span",2),v["\u0275\u0275text"](3),v["\u0275\u0275pipe"](4,"number"),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementContainerEnd"]()}if(2&e){var n=v["\u0275\u0275nextContext"]();v["\u0275\u0275advance"](1),v["\u0275\u0275styleProp"]("height",n.timesheet.totalHours/10*300,"px"),v["\u0275\u0275property"]("ngClass",2===n.timesheet.status?"accent":"warn"),v["\u0275\u0275advance"](2),v["\u0275\u0275textInterpolate1"](" ",v["\u0275\u0275pipeBind2"](4,4,n.timesheet.totalHours,"1.0-1"),"t ")}}var ne=function(){function e(){this.barClicked=new v.EventEmitter}return e.prototype.clickBar=function(){this.barClicked.emit()},e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=v["\u0275\u0275defineComponent"]({type:e,selectors:[["app-timesheet-mission-bar"]],inputs:{timesheet:"timesheet"},outputs:{barClicked:"barClicked"},decls:1,vars:1,consts:[[4,"ngIf"],["fxLayout","column","fxLayoutAlign","center center","matRipple","",1,"mission-bar","mat-elevation-z1",3,"ngClass","click"],[1,"mat-body-strong"]],template:function(e,t){1&e&&v["\u0275\u0275template"](0,ie,5,7,"ng-container",0),2&e&&v["\u0275\u0275property"]("ngIf",t.timesheet)},directives:[w.m,_.c,_.b,G.l,w.k,q.a],pipes:[w.f],styles:[".mission-bar[_ngcontent-%COMP%]{border-radius:4px!important;padding:2px!important;text-align:center}"],changeDetection:0}),e}(),re=i("f0Cb"),ae=i("hhBj"),oe=i("953d"),ce=function(){function e(){}return e.prototype.transform=function(e,t){if(!e||0===Object.keys(e).length)return new Date;var i=Object(oe.a)(Object(l.a)(e.weekNr,e.year));return(t||e.weekDay)&&i.setDate(i.getDate()+(t-1)||e.weekDay),i},e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=v["\u0275\u0275definePipe"]({name:"getDateByDateParams",type:e,pure:!0}),e}(),se=i("RHY+");function le(e,t){if(1&e){var i=v["\u0275\u0275getCurrentView"]();v["\u0275\u0275elementStart"](0,"app-timesheet-mission-bar",7),v["\u0275\u0275listener"]("barClicked",(function(){v["\u0275\u0275restoreView"](i);var e=t.$implicit;return v["\u0275\u0275nextContext"](3).timesheetClicked.emit(e)})),v["\u0275\u0275elementEnd"]()}2&e&&v["\u0275\u0275property"]("timesheet",t.$implicit)}function pe(e,t){if(1&e&&(v["\u0275\u0275elementContainerStart"](0),v["\u0275\u0275template"](1,le,1,1,"app-timesheet-mission-bar",6),v["\u0275\u0275pipe"](2,"sortByDate"),v["\u0275\u0275elementContainerEnd"]()),2&e){var i=v["\u0275\u0275nextContext"]().$implicit,n=v["\u0275\u0275nextContext"]();v["\u0275\u0275advance"](1),v["\u0275\u0275property"]("ngForOf",v["\u0275\u0275pipeBind3"](2,2,n.vm.weekDaySummaries[i].timesheets,"startTime","asc"))("ngForTrackBy",n.trackByTimesheet)}}function ue(e,t){1&e&&v["\u0275\u0275element"](0,"mat-divider",8)}function me(e,t){if(1&e){var i=v["\u0275\u0275getCurrentView"]();v["\u0275\u0275elementContainerStart"](0),v["\u0275\u0275elementStart"](1,"div",2),v["\u0275\u0275elementStart"](2,"app-timesheet-day-label",3),v["\u0275\u0275listener"]("labelClicked",(function(e){return v["\u0275\u0275restoreView"](i),v["\u0275\u0275nextContext"]().labelClicked.emit(e)})),v["\u0275\u0275pipe"](3,"getDateByDateParams"),v["\u0275\u0275elementEnd"](),v["\u0275\u0275template"](4,pe,3,6,"ng-container",4),v["\u0275\u0275elementEnd"](),v["\u0275\u0275template"](5,ue,1,0,"mat-divider",5),v["\u0275\u0275elementContainerEnd"]()}if(2&e){var n=t.$implicit,r=v["\u0275\u0275nextContext"]();v["\u0275\u0275advance"](2),v["\u0275\u0275property"]("date",v["\u0275\u0275pipeBind2"](3,3,r.vm.weekCriteria,n)),v["\u0275\u0275advance"](2),v["\u0275\u0275property"]("ngIf",r.vm.weekDaySummaries&&r.vm.weekDaySummaries[n]),v["\u0275\u0275advance"](1),v["\u0275\u0275property"]("ngIf",7!==n)}}var de=function(){function e(){this.timesheetClicked=new v.EventEmitter,this.labelClicked=new v.EventEmitter,this.trackByTimesheet=Object(U.a)("timesheets")}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=v["\u0275\u0275defineComponent"]({type:e,selectors:[["app-user-timesheet-week-view"]],inputs:{vm:"vm"},outputs:{timesheetClicked:"timesheetClicked",labelClicked:"labelClicked"},decls:3,vars:3,consts:[["fxLayout","row",2,"min-height","100%"],[4,"ngFor","ngForOf"],["fxLayout","column","fxLayoutAlign","start stretch",1,"w-100"],[1,"w-100","mb-1",2,"z-index","1","position","sticky","top","0",3,"date","labelClicked"],[4,"ngIf"],["vertical","true",4,"ngIf"],["class","fadeInDown","style","margin:2px",3,"timesheet","barClicked",4,"ngFor","ngForOf","ngForTrackBy"],[1,"fadeInDown",2,"margin","2px",3,"timesheet","barClicked"],["vertical","true"]],template:function(e,t){1&e&&(v["\u0275\u0275elementStart"](0,"div",0),v["\u0275\u0275template"](1,me,6,6,"ng-container",1),v["\u0275\u0275pipe"](2,"arrayFromNumber"),v["\u0275\u0275elementEnd"]()),2&e&&(v["\u0275\u0275advance"](1),v["\u0275\u0275property"]("ngForOf",v["\u0275\u0275pipeBind1"](2,1,t.vm.isXs?5:7)))},directives:[_.c,w.l,_.b,te,w.m,ne,re.a],pipes:[ae.a,ce,se.a],encapsulation:2,changeDetection:0}),e}(),fe=[{path:"",component:function(){function e(e,t,i,r,a,f,h){var v=this;this.router=e,this.route=t,this.dialog=i,this.deviceInfoService=r,this.facade=a,this.modelFormService=f,this.formService=h,this.navConfig$=this.facade.weekCriteria$.pipe(Object(c.a)((function(e){return v.getNavConfig(e)}))),this.vm$=Object(o.a)([this.facade.weekDaySummaries$,this.deviceInfoService.isXs$]).pipe(Object(c.a)((function(e){var t=Object(n.c)(e,2);return{isXs:t[1],weekDaySummaries:t[0],weekCriteria:v.facade.weekCriteria}}))),this.nextWeek=function(){return v.facade.nextWeek()},this.previousWeek=function(){return v.facade.previousWeek()},this.openTimesheetForm=function(e,t){var i;i=e?m.b:Object(n.a)(Object(n.a)({},m.a),{disabledControls:Object(s.a)(t)}),v.modelFormService.open({formConfig:{dynamicForm:Object(n.a)(Object(n.a)({},i),{initialValue:t}),entityId:e,adapter:d.a,stateProp:"userTimesheets"}})},this.openTimesheetCard=function(e){return v.dialog.open(g,{data:e,panelClass:"extended-dialog"})},this.goToTimesheetList=function(){var e=v.facade.weekCriteria,t=e.weekNr,i=e.year;v.router.navigate(["liste",{criteria:JSON.stringify({dateRange:Object(p.a)(Object(l.a)(t,i))})}],{relativeTo:v.route})},this.openWeekFilter=function(){v.formService.open({formConfig:Object(n.a)(Object(n.a)({},u.a),{disabledControls:{user:!0},noRenderDisabledControls:!0,initialValue:v.facade.weekCriteria}),navConfig:{title:"Velg filtre"},submitCallback:function(e){return v.facade.updateCriteria(e)}})}}return e.prototype.getNavConfig=function(e){var t;return{title:"Uke "+(null==e?void 0:e.weekNr)||!1,subTitle:(null===(t=null==e?void 0:e.year)||void 0===t?void 0:t.toString())||"",buttons:[{icon:"filter_list",color:"accent",callback:this.openWeekFilter},{icon:"list",callback:this.goToTimesheetList}]}},e.\u0275fac=function(t){return new(t||e)(v["\u0275\u0275directiveInject"](a.b),v["\u0275\u0275directiveInject"](a.a),v["\u0275\u0275directiveInject"](f.b),v["\u0275\u0275directiveInject"](X.a),v["\u0275\u0275directiveInject"](A),v["\u0275\u0275directiveInject"](J.ModelFormService),v["\u0275\u0275directiveInject"](z.FormService))},e.\u0275cmp=v["\u0275\u0275defineComponent"]({type:e,selectors:[["app-user-timesheet-week"]],features:[v["\u0275\u0275ProvidersFeature"](R)],decls:5,vars:6,consts:[["disableElevation","true","overlayMode","true"],["navbar","",3,"config"],[2,"height","100%","display","block",3,"vm","swiperight","swipeleft","timesheetClicked","labelClicked"]],template:function(e,t){1&e&&(v["\u0275\u0275elementStart"](0,"app-main-skeleton",0),v["\u0275\u0275element"](1,"app-main-top-nav-bar",1),v["\u0275\u0275pipe"](2,"async"),v["\u0275\u0275elementStart"](3,"app-user-timesheet-week-view",2),v["\u0275\u0275listener"]("swiperight",(function(){return t.previousWeek()}))("swipeleft",(function(){return t.nextWeek()}))("timesheetClicked",(function(e){return 2===(null==e?null:e.status)?t.openTimesheetCard(null==e?null:e.id):t.openTimesheetForm(null==e?null:e.id)}))("labelClicked",(function(e){return t.openTimesheetForm(null,{date:e})})),v["\u0275\u0275pipe"](4,"async"),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"]()),2&e&&(v["\u0275\u0275advance"](1),v["\u0275\u0275property"]("config",v["\u0275\u0275pipeBind1"](2,2,t.navConfig$)),v["\u0275\u0275advance"](2),v["\u0275\u0275property"]("vm",v["\u0275\u0275pipeBind1"](4,4,t.vm$)))},directives:[H.a,K.a,de],pipes:[w.b],encapsulation:2,changeDetection:0}),e}(),data:{child:!0},children:[{path:"liste",data:{child:!0},loadChildren:function(){return i.e(0).then(i.bind(null,"Q+mn")).then((function(e){return e.UserTimesheetListModule}))}}]}],he=function(){function e(){}return e.\u0275mod=v["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=v["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[a.f.forChild(fe)],a.f]}),e}(),ve=i("GxAf"),ke=i("XLlq"),Ce=i("9RCi"),we=i("9AJY"),ge=function(){function e(){}return e.\u0275mod=v["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=v["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},providers:Object(n.d)(ve.b,we.a),imports:[[r.a,ke.a,Ce.a,he]]}),e}()}}]);
//# sourceMappingURL=24.6dc6a55116912f23a8b8.js.map