(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{PvB8:function(e,t,n){"use strict";n.r(t),n.d(t,"MissionDocumentListModule",(function(){return ie}));var i=n("mrSG"),o=n("9AJY"),r=n("XLlq"),a=n("PCNd"),c=n("9RCi"),l=n("tyNb"),s=n("itXk"),u=n("lJxs"),d=n("xzsT"),p=n("1YJq"),m=n("u3SY"),f=n("6NQd"),v=n("rEs6"),g=n("3Pt+"),y=n("DICB"),x=n("SSDc"),b=n("+N20"),h=n("fXoL"),I=n("XiUz"),S=n("ofXK"),j=n("kmnG");function w(e,t){if(1&e&&(h["\u0275\u0275elementStart"](0,"div",4),h["\u0275\u0275text"](1),h["\u0275\u0275elementEnd"]()),2&e){var n=h["\u0275\u0275nextContext"]();h["\u0275\u0275advance"](1),h["\u0275\u0275textInterpolate"](n.question.label)}}function C(e,t){if(1&e&&(h["\u0275\u0275elementStart"](0,"mat-hint"),h["\u0275\u0275text"](1),h["\u0275\u0275elementEnd"]()),2&e){var n=h["\u0275\u0275nextContext"]();h["\u0275\u0275advance"](1),h["\u0275\u0275textInterpolate"](n.question.hint)}}function D(e,t){if(1&e&&(h["\u0275\u0275elementStart"](0,"mat-error"),h["\u0275\u0275text"](1),h["\u0275\u0275elementEnd"]()),2&e){var n=h["\u0275\u0275nextContext"]();h["\u0275\u0275advance"](1),h["\u0275\u0275textInterpolate1"](" ",n.getValidationErrorMessage()," ")}}var F,O=function(e){function t(t){return e.call(this,t)||this}return Object(i.b)(t,e),t.prototype.onFileChange=function(e){if(!e.target.files)return this.control.reset();this.control.markAsDirty(),this.control.setValue(this.question.multiple?e.target.files:e.target.files[0])},t.\u0275fac=function(e){return new(e||t)(h["\u0275\u0275directiveInject"](x.a))},t.\u0275cmp=h["\u0275\u0275defineComponent"]({type:t,selectors:[["app-file-question"]],features:[h["\u0275\u0275InheritDefinitionFeature"]],decls:5,vars:5,consts:[["fxLayout","column",1,"mt-3","mb-3"],["class","mat-body",4,"ngIf"],["type","file",3,"change"],[4,"ngIf"],[1,"mat-body"]],template:function(e,t){1&e&&(h["\u0275\u0275elementStart"](0,"div",0),h["\u0275\u0275template"](1,w,2,1,"div",1),h["\u0275\u0275elementStart"](2,"input",2),h["\u0275\u0275listener"]("change",(function(e){return t.onFileChange(e)})),h["\u0275\u0275elementEnd"](),h["\u0275\u0275template"](3,C,2,1,"mat-hint",3),h["\u0275\u0275template"](4,D,2,1,"mat-error",3),h["\u0275\u0275elementEnd"]()),2&e&&(h["\u0275\u0275advance"](1),h["\u0275\u0275property"]("ngIf",t.question.label),h["\u0275\u0275advance"](1),h["\u0275\u0275attribute"]("multiple",t.question.multiple)("required",t.required),h["\u0275\u0275advance"](1),h["\u0275\u0275property"]("ngIf",t.question.hint),h["\u0275\u0275advance"](1),h["\u0275\u0275property"]("ngIf",t.control.dirty&&t.control.invalid))},directives:[I.c,S.m,j.f,j.b],encapsulation:2,changeDetection:0}),t}(b.a),k=n("/XYe"),E=n("NE9p"),P={submitText:"Legg til",controls:[{name:"documentType",type:"group",controls:[{name:"name",required:!0,type:"control",questions:[{component:y.a,question:{optionsGetter:function(e){return e.options.documentTypes},placeholder:"Velg type dokument",valueProp:"name",valueFormatter:function(e){return e.name},resetable:!0,activeFilter:{stringProps:["name"]}}}],validators:[g.q.maxLength(45)]}]},{name:"file",required:!0,type:"control",questions:[{component:O,question:{}}],validators:[(F=["doc","docm","docx","txt","pdf","dot","csv","dotm","dotx","xla","odt","xlam","xls","xlsb","xlsm","xlsx","xlt","xlw"],function(e){return null==e.value||Object(k.a)(e.value,F)?null:{fileextension:{value:e.value}}})]},E.f]},M=n("G1JD"),q=n("/bry"),T=n("sNHF"),L=n("KaUG"),N=n("t7j9"),R=n("NlAt"),B=n("FnCK"),V=n("c6Pr"),$=n("swmS"),X=n("sYIv"),J=function(){function e(e){var t=this;this.store=e,this.delete=function(e){return t.store.dispatch(Object(i.a)(Object(i.a)({},e),{stateProp:"missionDocuments",actionId:V.a}))},this.mailDocuments=function(e,n){return t.store.dispatch({toEmail:e,ids:n,stateProp:"missionDocuments",actionId:$.a})}}return e.prototype.getMissionDocuments$=function(e){return this.store.select$(["missionDocuments","employers","documentTypes"]).pipe(Object(u.a)((function(t){var n=new R.a("missionDocuments",null,["documentTypes"]);return Object(N.a)(t,n,(function(t){return t.missionId===e}))})))},e.prototype.getMissionEmployerEmail=function(e){var t,n=new R.a("missions",null,["employers"]),i=this.store.select(["missions","employers"],!1),o=Object(B.a)(i,n,e);return null===(t=null==o?void 0:o.employer)||void 0===t?void 0:t.email},e.\u0275fac=function(t){return new(t||e)(h["\u0275\u0275inject"](X.a))},e.\u0275prov=h["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"any"}),e}(),K=n("lMzk"),Y=n("M6VK"),G=n("WAJ7"),A=n("tYFc"),z=n("ci80"),U=n("ILfg"),W=n("NFeN"),_=function(){function e(){}return e.prototype.transform=function(e){switch(e){case"csv":return p.Icons.Csv;case"pdf":return p.Icons.Pdf;case"jpg":case"png":return p.Icons.ImageFile;case"doc":case"docm":case"docx":case"dot":case"dotm":case"dotx":return p.Icons.Word;case"xla":case"xlam":case"xls":case"xlsb":case"xlsm":case"xlsx":case"xlt":case"xlw":return p.Icons.Excel;default:return p.Icons.DefaultFile}},e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=h["\u0275\u0275definePipe"]({name:"fileExtensionIcon",type:e,pure:!0}),e}(),H=function(){function e(){}return e.prototype.transform=function(e){return null==e?void 0:e.split(".").pop()},e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=h["\u0275\u0275definePipe"]({name:"fileExtension",type:e,pure:!0}),e}();function Q(e,t){if(1&e){var n=h["\u0275\u0275getCurrentView"]();h["\u0275\u0275elementStart"](0,"app-selectable-list",5,6),h["\u0275\u0275listener"]("selectionChanged",(function(e){return h["\u0275\u0275restoreView"](n),h["\u0275\u0275nextContext"](2).onSelectionChange(e)}))("itemClicked",(function(e){return h["\u0275\u0275restoreView"](n),h["\u0275\u0275nextContext"](2).downloadDocument(e)})),h["\u0275\u0275elementEnd"]()}if(2&e){var i=h["\u0275\u0275nextContext"]().$implicit;h["\u0275\u0275nextContext"]();var o=h["\u0275\u0275reference"](3);h["\u0275\u0275property"]("totalRows",i.isXs?2:4)("entities",i.documents)("itemTemplate",o)}}function Z(e,t){if(1&e&&(h["\u0275\u0275elementStart"](0,"app-main-skeleton",2),h["\u0275\u0275element"](1,"app-main-top-nav-bar",3),h["\u0275\u0275template"](2,Q,2,3,"app-selectable-list",4),h["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit;h["\u0275\u0275property"]("fabs",n.fabs),h["\u0275\u0275advance"](1),h["\u0275\u0275property"]("config",n.navConfig),h["\u0275\u0275advance"](1),h["\u0275\u0275property"]("ngIf",n.documents)}}function ee(e,t){if(1&e&&(h["\u0275\u0275elementStart"](0,"div",7),h["\u0275\u0275element"](1,"mat-icon",8),h["\u0275\u0275pipe"](2,"fileExtensionIcon"),h["\u0275\u0275pipe"](3,"fileExtension"),h["\u0275\u0275elementStart"](4,"div"),h["\u0275\u0275text"](5),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](6,"div",9),h["\u0275\u0275text"](7),h["\u0275\u0275pipe"](8,"uppercase"),h["\u0275\u0275pipe"](9,"fileExtension"),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](10,"div",9),h["\u0275\u0275text"](11),h["\u0275\u0275pipe"](12,"date"),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit;h["\u0275\u0275advance"](1),h["\u0275\u0275property"]("svgIcon",h["\u0275\u0275pipeBind1"](2,4,h["\u0275\u0275pipeBind1"](3,6,n.fileName))),h["\u0275\u0275advance"](4),h["\u0275\u0275textInterpolate"](null==n.documentType?null:n.documentType.name),h["\u0275\u0275advance"](2),h["\u0275\u0275textInterpolate1"]("Filtype: ",h["\u0275\u0275pipeBind1"](8,8,h["\u0275\u0275pipeBind1"](9,10,n.fileName)),""),h["\u0275\u0275advance"](4),h["\u0275\u0275textInterpolate1"]("Lastet opp ",h["\u0275\u0275pipeBind2"](12,12,n.updatedAt,"dd.MMM yyyy"),"")}}var te=[{path:"",component:function(e){function t(t,n,o,r,a,c,l,f,g){var y=e.call(this)||this;return y.deviceInfoService=t,y.formService=n,y.downloaderService=o,y.facade=r,y.route=a,y.router=c,y.notificationService=l,y.confirmService=f,y.modelFormService=g,y.vm$=Object(s.a)([y.facade.getMissionDocuments$(y.missionId),y.deviceInfoService.isXs$,y.currentFabs$]).pipe(Object(u.a)((function(e){var t=Object(i.c)(e,3);return{documents:t[0],isXs:t[1],fabs:t[2],navConfig:y.navConfig}}))),y.downloadDocument=function(e){return y.downloaderService.downloadUrl(Object(m.a)(e.fileName,"documents"))},y.deleteSelectedDocuments=function(){y.facade.delete({ids:y.currentSelections}),y.selectableList.clearSelections()},y.openConfirmDeleteDialog=function(){y.confirmService.open({title:"Slett utvalgte dokumenter?",confirmText:"Slett",confirmCallback:y.deleteSelectedDocuments})},y.openMailDocumentSheet=function(){y.formService.open({formConfig:Object(i.a)(Object(i.a)({},v.a),{initialValue:{email:y.facade.getMissionEmployerEmail(y.missionId)}}),navConfig:{title:"Send Dokumenter"},submitCallback:function(e){y.facade.mailDocuments(e.email,y.currentSelections),y.selectableList.clearSelections()}})},y.openDocumentForm=function(){if(!window.navigator.onLine)return y.notificationService.notify(d.a.OnlineRequired);y.modelFormService.open({formConfig:{dynamicForm:Object(i.a)(Object(i.a)({},P),{initialValue:{missionId:y.missionId}}),adapter:M.a,stateProp:"missionDocuments"}})},y.onBack=function(){return y.router.navigate(["../"],{relativeTo:y.route.parent})},y.navConfig={title:"Dokumenter",backFn:y.onBack},y.staticFabs=[{icon:"note_add",aria:"Legg til",color:"accent",callback:y.openDocumentForm,allowedRoles:[p.Roles.Leder]}],y.selectedItemsFabs=[{icon:"send",aria:"Send",color:"accent",callback:y.openMailDocumentSheet,allowedRoles:[p.Roles.Leder]},{icon:"delete_forever",aria:"Slett",color:"warn",callback:y.openConfirmDeleteDialog,allowedRoles:[p.Roles.Leder]}],y}return Object(i.b)(t,e),Object.defineProperty(t.prototype,"missionId",{get:function(){return this.route.parent.parent.snapshot.params.id},enumerable:!1,configurable:!0}),t.\u0275fac=function(e){return new(e||t)(h["\u0275\u0275directiveInject"](q.a),h["\u0275\u0275directiveInject"](T.FormService),h["\u0275\u0275directiveInject"](L.a),h["\u0275\u0275directiveInject"](J),h["\u0275\u0275directiveInject"](l.a),h["\u0275\u0275directiveInject"](l.b),h["\u0275\u0275directiveInject"](K.NotificationService),h["\u0275\u0275directiveInject"](Y.a),h["\u0275\u0275directiveInject"](G.ModelFormService))},t.\u0275cmp=h["\u0275\u0275defineComponent"]({type:t,selectors:[["app-mission-document-list"]],features:[h["\u0275\u0275InheritDefinitionFeature"]],decls:5,vars:3,consts:[["overlayMode","true",3,"fabs",4,"ngIf"],["documentTemplate",""],["overlayMode","true",3,"fabs"],["navbar","",3,"config"],["identifier","id","selectedText","Dokument valgt","selectionText","",3,"totalRows","entities","itemTemplate","selectionChanged","itemClicked",4,"ngIf"],["identifier","id","selectedText","Dokument valgt","selectionText","",3,"totalRows","entities","itemTemplate","selectionChanged","itemClicked"],["selectableList",""],[1,"foreground-card","text-center","mat-elevation-z2","p-2","pt-6","pb-6","m-1"],[1,"scale-150","mb-2",3,"svgIcon"],[1,"mat-caption"]],template:function(e,t){1&e&&(h["\u0275\u0275template"](0,Z,3,3,"app-main-skeleton",0),h["\u0275\u0275pipe"](1,"async"),h["\u0275\u0275template"](2,ee,13,15,"ng-template",null,1,h["\u0275\u0275templateRefExtractor"]),h["\u0275\u0275element"](4,"router-outlet")),2&e&&h["\u0275\u0275property"]("ngIf",h["\u0275\u0275pipeBind1"](1,1,t.vm$))},directives:[S.m,l.g,A.a,z.a,U.a,W.a],pipes:[S.b,_,H,S.u,S.e],encapsulation:2,changeDetection:0}),t}(f.a)}],ne=function(){function e(){}return e.\u0275mod=h["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=h["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[l.f.forChild(te)],l.f]}),e}(),ie=function(){function e(){}return e.\u0275mod=h["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=h["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},providers:Object(i.d)(o.b),imports:[[a.a,c.a,r.a,ne]]}),e}()},t7j9:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("mrSG"),o=n("8Mnh"),r=n("O/YV"),a=n("Uejg"),c=n("cT5K");function l(e,t,n){var l=c.a.get(t.modelProp),d=e[t.modelProp];if(n&&(d=Object(r.a)(d,n)),!d||0==d.length)return d;var p=t.includedChildProps&&t.includedChildProps.length>0,m=t.includedForeignProps&&t.includedForeignProps.length>0,f={};m&&(f=function(e,t){var n,r,a={};try{for(var l=Object(i.e)(e),s=l.next();!s.done;s=l.next()){var u=s.value,d=c.a.get(u);a[u]=Object(o.a)(t[u],d.identifier)}}catch(p){n={error:p}}finally{try{s&&!s.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}return a}(t.includedForeignProps,e));var v={};if(p&&(v=function(e,t,n){var o,r,c={};try{for(var l=Object(i.e)(e),s=l.next();!s.done;s=l.next()){var u=s.value;c[u]=Object(a.a)(n[u],t)}}catch(d){o={error:d}}finally{try{s&&!s.done&&(r=l.return)&&r.call(l)}finally{if(o)throw o.error}}return c}(t.includedChildProps,l.foreignKey,e)),m||p)for(var g=0;g<d.length;g++){var y=d[g];s(t.includedForeignProps,f,y),u(t.includedChildProps,l,v,y),d[g]=y}return d}function s(e,t,n){var o,r;try{for(var a=Object(i.e)(e),l=a.next();!l.done;l=a.next()){var s=l.value,u=c.a.get(s);n[u.foreignProp]=t[s][n[u.foreignKey]]}}catch(d){o={error:d}}finally{try{l&&!l.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}}function u(e,t,n,o){var r,a;try{for(var c=Object(i.e)(e),l=c.next();!l.done;l=c.next()){var s=l.value;o[s]=n[s][o[t.identifier]]}}catch(u){r={error:u}}finally{try{l&&!l.done&&(a=c.return)&&a.call(c)}finally{if(r)throw r.error}}}}}]);
//# sourceMappingURL=20.844ddade8c27710e4f6d.js.map