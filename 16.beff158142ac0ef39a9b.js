(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{"YWl/":function(e,t,n){"use strict";n.r(t),n.d(t,"TimesheetModule",(function(){return de}));var i=n("DUip"),r=n("67Y/"),a=n("15JJ"),o=n("ea4N"),s=n("F/XL"),c=n("9Z1F"),m=n("TYT/"),p=n("dJ3e"),l=n("kxXi"),d=n("Valr"),u=function(){function e(e,t,n){this.userTimesheetService=e,this.dialogRef=t,this.timesheetId=n,this.timesheet$=this.userTimesheetService.getWithMission$(this.timesheetId).pipe(Object(c.a)((function(e){return Object(s.a)(null)})))}return e.prototype.deleteTimesheet=function(){var e=this;this.userTimesheetService.delete$(this.timesheetId).subscribe((function(t){return e.dialogRef.close()}))},e.\u0275fac=function(t){return new(t||e)(m["\u0275\u0275directiveInject"](p.B),m["\u0275\u0275directiveInject"](o.e),m["\u0275\u0275directiveInject"](o.a))},e.\u0275cmp=m["\u0275\u0275defineComponent"]({type:e,selectors:[["app-timesheet-card-dialog-wrapper"]],decls:2,vars:3,consts:[[3,"timesheet","deleteClicked"]],template:function(e,t){1&e&&(m["\u0275\u0275elementStart"](0,"app-timesheet-card",0),m["\u0275\u0275listener"]("deleteClicked",(function(){return t.deleteTimesheet()})),m["\u0275\u0275pipe"](1,"async"),m["\u0275\u0275elementEnd"]()),2&e&&m["\u0275\u0275property"]("timesheet",m["\u0275\u0275pipeBind1"](1,1,t.timesheet$))},directives:[l.a],pipes:[d.b],encapsulation:2,changeDetection:0}),e}(),h=n("h/AT"),g=n("9tSM"),f=n("k5Aa"),v=n("xMyE"),b=n("26FU"),y=n("QJY3"),C=n("VnD/"),x=n("Gi3i"),P=n("uLXW"),S=n("eHTH"),k=n("cSbt"),O=n("iYur"),w=n("z17N"),M=n("p+mS"),T=n("Up+3"),_=n("MqYC");function I(e,t){if(1&e&&(m["\u0275\u0275elementStart"](0,"mat-option",17),m["\u0275\u0275text"](1),m["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit;m["\u0275\u0275property"]("value",n),m["\u0275\u0275advance"](1),m["\u0275\u0275textInterpolate2"](" (",n.id,") ",n.address," ")}}function F(e,t){if(1&e){var n=m["\u0275\u0275getCurrentView"]();m["\u0275\u0275elementStart"](0,"form",1),m["\u0275\u0275elementStart"](1,"mat-form-field"),m["\u0275\u0275element"](2,"input",2),m["\u0275\u0275elementStart"](3,"mat-autocomplete",3,4),m["\u0275\u0275template"](5,I,2,3,"mat-option",5),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementStart"](6,"span",6),m["\u0275\u0275elementStart"](7,"label",7),m["\u0275\u0275elementStart"](8,"mat-form-field",8),m["\u0275\u0275element"](9,"input",9),m["\u0275\u0275elementEnd"](),m["\u0275\u0275element"](10,"owl-date-time",10,11),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementStart"](12,"label",7),m["\u0275\u0275elementStart"](13,"mat-form-field",8),m["\u0275\u0275element"](14,"input",12),m["\u0275\u0275elementEnd"](),m["\u0275\u0275element"](15,"owl-date-time",13,14),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementStart"](17,"mat-form-field"),m["\u0275\u0275element"](18,"textarea",15),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementStart"](19,"button",16),m["\u0275\u0275listener"]("click",(function(){return m["\u0275\u0275restoreView"](n),m["\u0275\u0275nextContext"]().onSubmit()})),m["\u0275\u0275text"](20),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"]()}if(2&e){var i=m["\u0275\u0275reference"](4),r=m["\u0275\u0275reference"](11),a=m["\u0275\u0275reference"](16),o=m["\u0275\u0275nextContext"]();m["\u0275\u0275property"]("formGroup",o.timesheetForm),m["\u0275\u0275advance"](2),m["\u0275\u0275property"]("matAutocomplete",i),m["\u0275\u0275advance"](1),m["\u0275\u0275property"]("displayWith",o.displayMissionAddress),m["\u0275\u0275advance"](2),m["\u0275\u0275property"]("ngForOf",o.missions),m["\u0275\u0275advance"](4),m["\u0275\u0275property"]("owlDateTimeTrigger",r)("owlDateTime",r),m["\u0275\u0275advance"](1),m["\u0275\u0275property"]("pickerMode","dialog")("pickerType","calendar"),m["\u0275\u0275advance"](4),m["\u0275\u0275property"]("owlDateTimeTrigger",a)("owlDateTime",a),m["\u0275\u0275advance"](1),m["\u0275\u0275property"]("pickerType","timer")("pickerMode","dialog")("startAt",(null==o.timesheet?null:o.timesheet.startTime)||o.initTime),m["\u0275\u0275advance"](4),m["\u0275\u0275property"]("disabled",o.timesheetForm.invalid||o.timesheetForm.pristine),m["\u0275\u0275advance"](1),m["\u0275\u0275textInterpolate1"](" ",o.isCreateForm?"Legg til":"Oppdater"," ")}}var j=function(){function e(e){var t=this;this._formBuilder=e,this.formSubmitted=new m.EventEmitter,this.missionsSearch=new m.EventEmitter,this.isCreateForm=!1,this.initTime=new Date,this.onSubmit=function(){t.timesheetForm.valid&&t.timesheetForm.dirty&&t.formSubmitted.emit(t.convertFormToTimesheet(t.timesheetForm.getRawValue()))},this.initTime.setHours(6,0,0,0)}return e.prototype.ngOnInit=function(){var e=this;this.timesheet&&null!=this.timesheet?this.timesheet.mission=this.missions.find((function(t){return t.id==e.timesheet.missionId})):this.isCreateForm=!0,this.initalizeForm(this.timesheet),this.initMissionListener()},e.prototype.displayMissionAddress=function(e){return null==e?null:e.address},e.prototype.initalizeForm=function(e){this.timesheetForm=this._formBuilder.group({id:e?e.id:null,mission:[{value:this.missionPreset||(e?e.mission:null),disabled:this.missionPreset},[y.s.required]],date:[{value:this.datePreset||(this.isCreateForm?null:new Date(e.startTime)),disabled:this.datePreset},[y.s.required]],timeRange:[this.isCreateForm?[]:[new Date(e.startTime),new Date(e.endTime)],[y.s.required,this.timeRangeValidator()]],comment:[e?e.comment:null,[y.s.required,y.s.maxLength(400)]]},{validators:this.isMissionValidator()})},e.prototype.initMissionListener=function(){var e=this;this.mission.valueChanges.pipe(Object(C.a)((function(e){return"string"==typeof e})),Object(x.a)(400)).subscribe((function(t){return e.missionsSearch.emit(t)}))},e.prototype.timeRangeValidator=function(){return function(e){return e.value[0]&&e.value[1]?null:{timeRangeInvalid:{value:e.value}}}},e.prototype.isMissionValidator=function(){return function(e){return e.value.mission instanceof Object?null:{missionInvalid:{value:e.value}}}},e.prototype.convertFormToTimesheet=function(e){var t=e.date.toDateString();return{id:e.id,missionId:e.mission.id,comment:e.comment,startTime:new Date(t+" "+e.timeRange[0].toTimeString()),endTime:new Date(t+" "+e.timeRange[1].toTimeString())}},Object.defineProperty(e.prototype,"mission",{get:function(){return this.timesheetForm.get("mission")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"date",{get:function(){return this.timesheetForm.get("date")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timeRange",{get:function(){return this.timesheetForm.get("timeRange")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"comment",{get:function(){return this.timesheetForm.get("comment")},enumerable:!0,configurable:!0}),e.\u0275fac=function(t){return new(t||e)(m["\u0275\u0275directiveInject"](y.c))},e.\u0275cmp=m["\u0275\u0275defineComponent"]({type:e,selectors:[["app-timesheet-form-view"]],inputs:{missions:"missions",timesheet:"timesheet",datePreset:"datePreset",missionPreset:"missionPreset"},outputs:{formSubmitted:"formSubmitted",missionsSearch:"missionsSearch"},decls:1,vars:1,consts:[["fxLayout","column","fxLayoutAlign","start stretch",3,"formGroup",4,"ngIf"],["fxLayout","column","fxLayoutAlign","start stretch",3,"formGroup"],["matInput","","placeholder","Oppdrag","formControlName","mission","aria-label","Velg oppdrag",3,"matAutocomplete"],[3,"displayWith"],["auto1","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["fxLayout","row","fxLayoutAlign","space-between start"],["fxFlex","46"],[1,"w-100"],["matInput","","placeholder","Dato","formControlName","date","aria-label","Velg dato","required","",3,"owlDateTimeTrigger","owlDateTime"],[3,"pickerMode","pickerType"],["d3",""],["matInput","","placeholder","Arbeidstid","formControlName","timeRange","required","","selectMode","range",3,"owlDateTimeTrigger","owlDateTime"],["stepMinute","15",3,"pickerType","pickerMode","startAt"],["t1",""],["matInput","","placeholder","Kommentar","formControlName","comment","aria-label","Kommentar","required","","maxlength","400"],["appHttpCommandButton","","mat-raised-button","","color","primary",1,"w-100",3,"disabled","click"],[3,"value"]],template:function(e,t){1&e&&m["\u0275\u0275template"](0,F,21,15,"form",0),2&e&&m["\u0275\u0275property"]("ngIf",t.timesheetForm)},directives:[d.l,y.t,y.m,P.c,P.b,y.e,S.c,k.a,y.b,O.c,y.l,y.d,O.a,d.k,P.a,w.d,y.r,w.g,w.c,y.h,M.b,T.a,_.k],styles:[""],changeDetection:0}),e}(),D=function(){function e(e,t,n,i){var r=this;this._dateTimeService=e,this._userTimesheetService=t,this._missionService=n,this._notificationService=i,this.Roles=f.f,this.finished=new m.EventEmitter,this.missionsSearchSubject=new b.a(void 0),this.onMissionSearch=function(e){return r.missionsSearchSubject.next(e)}}return e.prototype.ngOnInit=function(){var e=this;this.missions$=this.missionsSearchSubject.asObservable().pipe(Object(a.a)((function(t){return e._missionService.getBy$((function(n){return e.filterMission(n,t)}))}))),this.timesheetIdPreset?this.timesheetPreset$=this._userTimesheetService.get$(this.timesheetIdPreset).pipe(Object(v.a)((function(t){t||e.finished.emit()}))):this.isCreateForm=!0},e.prototype.onSubmit=function(e){e&&null!=e||this.finished.emit(null),this.isCreateForm?this.createTimesheet(e):this.editTimesheet(e)},e.prototype.createTimesheet=function(e){var t=this;this._userTimesheetService.add$(e).subscribe((function(e){t._notificationService.setNotification("Time registrert!"),t.finished.emit(e)}))},e.prototype.editTimesheet=function(e){var t=this;this._userTimesheetService.update$(e).subscribe((function(e){t._notificationService.setNotification("Time oppdatert!"),t.finished.emit(e)}))},e.prototype.filterMission=function(e,t){if(!t)return this.filterInitialMission(e);var n=!t||null==t||e.address.toLowerCase().includes(t.toLowerCase()),i=+t;return isNaN(i)||(n=n||e.id===i),n},e.prototype.filterInitialMission=function(e){var t=this._dateTimeService.getNDaysAgo(30);return new Date(e.updatedAt).getTime()>=t||new Date(e.lastVisited).getTime()>=t},e.\u0275fac=function(t){return new(t||e)(m["\u0275\u0275directiveInject"](p.g),m["\u0275\u0275directiveInject"](p.B),m["\u0275\u0275directiveInject"](p.s),m["\u0275\u0275directiveInject"](p.v))},e.\u0275cmp=m["\u0275\u0275defineComponent"]({type:e,selectors:[["app-timesheet-form"]],inputs:{timesheetIdPreset:"timesheetIdPreset",datePreset:"datePreset",missionPreset:"missionPreset"},outputs:{finished:"finished"},decls:3,vars:8,consts:[[3,"missionPreset","datePreset","timesheet","missions","formSubmitted","missionsSearch"]],template:function(e,t){1&e&&(m["\u0275\u0275elementStart"](0,"app-timesheet-form-view",0),m["\u0275\u0275listener"]("formSubmitted",(function(e){return t.onSubmit(e)}))("missionsSearch",(function(e){return t.onMissionSearch(e)})),m["\u0275\u0275pipe"](1,"async"),m["\u0275\u0275pipe"](2,"async"),m["\u0275\u0275elementEnd"]()),2&e&&m["\u0275\u0275property"]("missionPreset",t.missionPreset)("datePreset",t.datePreset)("timesheet",m["\u0275\u0275pipeBind1"](1,4,t.timesheetPreset$))("missions",m["\u0275\u0275pipeBind1"](2,6,t.missions$))},directives:[j],pipes:[d.b],encapsulation:2,changeDetection:0}),e}(),N=function(){function e(e,t,n){var i=this;this._userTimesheetService=e,this._bottomSheetRef=t,this.data=n,this.close=function(){return i._bottomSheetRef.dismiss()},this.deleteTimesheet=function(){return i._userTimesheetService.delete$(i.data.timesheetIdPreset).subscribe((function(e){return i.close()}))}}return e.prototype.ngOnInit=function(){var e=!this.data||!this.data.timesheetIdPreset;this.navConfig={title:e?"Registrer time":"Rediger time",leftBtn:{icon:"close",callback:this.close},buttons:e?void 0:[{icon:"delete_forever",callback:this.deleteTimesheet}]}},e.\u0275fac=function(t){return new(t||e)(m["\u0275\u0275directiveInject"](p.B),m["\u0275\u0275directiveInject"](h.d),m["\u0275\u0275directiveInject"](h.a))},e.\u0275cmp=m["\u0275\u0275defineComponent"]({type:e,selectors:[["app-timesheet-form-sheet-wrapper"]],decls:2,vars:4,consts:[[3,"config"],[3,"datePreset","missionPreset","timesheetIdPreset","finished"]],template:function(e,t){1&e&&(m["\u0275\u0275elementStart"](0,"app-simple-top-nav",0),m["\u0275\u0275elementStart"](1,"app-timesheet-form",1),m["\u0275\u0275listener"]("finished",(function(){return t.close()})),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"]()),2&e&&(m["\u0275\u0275property"]("config",t.navConfig),m["\u0275\u0275advance"](1),m["\u0275\u0275property"]("datePreset",null==t.data?null:t.data.datePreset)("missionPreset",null==t.data?null:t.data.missionPreset)("timesheetIdPreset",null==t.data?null:t.data.timesheetIdPreset))},directives:[g.a,D],encapsulation:2,changeDetection:0}),e}(),E=n("GsDI"),R=function(){function e(e){this.dialog=e,this.labelClicked=new m.EventEmitter}return e.\u0275fac=function(t){return new(t||e)(m["\u0275\u0275directiveInject"](o.b))},e.\u0275cmp=m["\u0275\u0275defineComponent"]({type:e,selectors:[["app-timesheet-day-label"]],inputs:{date:"date"},outputs:{labelClicked:"labelClicked"},decls:13,vars:12,consts:[["fxLayout","column","fxLayoutAlign","start center","matRipple","",1,"mat-elevation-z2","bg-foreground","pt-2",3,"click"],["fxLayout","column","fxLayoutAlign","center center"],[1,"mat-h3","m-0","line-height-100"],[1,"mat-title","m-0","line-height-100"],[1,"mat-small","line-height-100"],[1,"icon","m-1"]],template:function(e,t){1&e&&(m["\u0275\u0275elementStart"](0,"span",0),m["\u0275\u0275listener"]("click",(function(){return t.labelClicked.emit(t.date)})),m["\u0275\u0275elementStart"](1,"div",1),m["\u0275\u0275elementStart"](2,"span",2),m["\u0275\u0275text"](3),m["\u0275\u0275pipe"](4,"date"),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementStart"](5,"span",3),m["\u0275\u0275text"](6),m["\u0275\u0275pipe"](7,"date"),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementStart"](8,"span",4),m["\u0275\u0275text"](9),m["\u0275\u0275pipe"](10,"date"),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementStart"](11,"mat-icon",5),m["\u0275\u0275text"](12,"add"),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"]()),2&e&&(m["\u0275\u0275advance"](3),m["\u0275\u0275textInterpolate1"](" ",m["\u0275\u0275pipeBind2"](4,3,t.date,"E")," "),m["\u0275\u0275advance"](3),m["\u0275\u0275textInterpolate1"](" ",m["\u0275\u0275pipeBind2"](7,6,t.date,"dd")," "),m["\u0275\u0275advance"](3),m["\u0275\u0275textInterpolate1"](" ",m["\u0275\u0275pipeBind2"](10,9,t.date,"MMM")," "))},directives:[P.c,P.b,_.n,E.a],pipes:[d.e],encapsulation:2,changeDetection:0}),e}(),B=n("qaSM"),L=function(e,t){return{"bg-accent-light":e,"bg-warn-light":t}};function V(e,t){if(1&e){var n=m["\u0275\u0275getCurrentView"]();m["\u0275\u0275elementStart"](0,"div",1),m["\u0275\u0275listener"]("click",(function(){return m["\u0275\u0275restoreView"](n),m["\u0275\u0275nextContext"]().clickBar()})),m["\u0275\u0275elementStart"](1,"span",2),m["\u0275\u0275text"](2),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"]()}if(2&e){var i=m["\u0275\u0275nextContext"]();m["\u0275\u0275property"]("ngClass",m["\u0275\u0275pureFunction2"](2,L,2==i.timesheet.status,0==i.timesheet.status)),m["\u0275\u0275advance"](2),m["\u0275\u0275textInterpolate1"](" ",i.timesheet.totalHours,"t ")}}var $=function(){function e(){this.barClicked=new m.EventEmitter}return e.prototype.clickBar=function(){this.barClicked.emit(this.timesheet.id)},e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=m["\u0275\u0275defineComponent"]({type:e,selectors:[["app-timesheet-mission-bar"]],inputs:{timesheet:"timesheet"},outputs:{barClicked:"barClicked"},decls:1,vars:1,consts:[["class","mission-bar mat-elevation-z1","fxLayout","column","fxLayoutAlign","center center","matRipple","",3,"ngClass","click",4,"ngIf"],["fxLayout","column","fxLayoutAlign","center center","matRipple","",1,"mission-bar","mat-elevation-z1",3,"ngClass","click"],[1,"mat-body-strong"]],template:function(e,t){1&e&&m["\u0275\u0275template"](0,V,3,5,"div",0),2&e&&m["\u0275\u0275property"]("ngIf",t.timesheet)},directives:[d.l,P.c,P.b,_.n,d.j,B.a],styles:[".m-0[_ngcontent-%COMP%]{margin:0}.mt-0[_ngcontent-%COMP%]{margin-top:0}.ml-0[_ngcontent-%COMP%]{margin-left:0}.mr-0[_ngcontent-%COMP%]{margin-right:0}.mb-0[_ngcontent-%COMP%]{margin-bottom:0}.m-1[_ngcontent-%COMP%]{margin:4px}.mt-1[_ngcontent-%COMP%]{margin-top:4px}.ml-1[_ngcontent-%COMP%]{margin-left:4px}.mr-1[_ngcontent-%COMP%]{margin-right:4px}.mb-1[_ngcontent-%COMP%]{margin-bottom:4px}.m-2[_ngcontent-%COMP%]{margin:8px}.mt-2[_ngcontent-%COMP%]{margin-top:8px}.ml-2[_ngcontent-%COMP%]{margin-left:8px}.mr-2[_ngcontent-%COMP%]{margin-right:8px}.mb-2[_ngcontent-%COMP%]{margin-bottom:8px}.m-3[_ngcontent-%COMP%]{margin:12px}.mt-3[_ngcontent-%COMP%]{margin-top:12px}.ml-3[_ngcontent-%COMP%]{margin-left:12px}.mr-3[_ngcontent-%COMP%]{margin-right:12px}.mb-3[_ngcontent-%COMP%]{margin-bottom:12px}.m-4[_ngcontent-%COMP%]{margin:16px}.mt-4[_ngcontent-%COMP%]{margin-top:16px}.ml-4[_ngcontent-%COMP%]{margin-left:16px}.mr-4[_ngcontent-%COMP%]{margin-right:16px}.mb-4[_ngcontent-%COMP%]{margin-bottom:16px}.m-5[_ngcontent-%COMP%]{margin:20px}.mt-5[_ngcontent-%COMP%]{margin-top:20px}.ml-5[_ngcontent-%COMP%]{margin-left:20px}.mr-5[_ngcontent-%COMP%]{margin-right:20px}.mb-5[_ngcontent-%COMP%]{margin-bottom:20px}.m-6[_ngcontent-%COMP%]{margin:24px}.mt-6[_ngcontent-%COMP%]{margin-top:24px}.ml-6[_ngcontent-%COMP%]{margin-left:24px}.mr-6[_ngcontent-%COMP%]{margin-right:24px}.mb-6[_ngcontent-%COMP%]{margin-bottom:24px}.m-auto[_ngcontent-%COMP%]{margin:auto}.mt-auto[_ngcontent-%COMP%]{margin-top:auto}.ml-auto[_ngcontent-%COMP%]{margin-left:auto}.mr-auto[_ngcontent-%COMP%]{margin-right:auto}.mb-auto[_ngcontent-%COMP%]{margin-bottom:auto}.p-0[_ngcontent-%COMP%]{padding:0}.pt-0[_ngcontent-%COMP%]{padding-top:0}.pl-0[_ngcontent-%COMP%]{padding-left:0}.pr-0[_ngcontent-%COMP%]{padding-right:0}.pb-0[_ngcontent-%COMP%]{padding-bottom:0}.p-1[_ngcontent-%COMP%]{padding:4px}.pt-1[_ngcontent-%COMP%]{padding-top:4px}.pl-1[_ngcontent-%COMP%]{padding-left:4px}.pr-1[_ngcontent-%COMP%]{padding-right:4px}.pb-1[_ngcontent-%COMP%]{padding-bottom:4px}.p-2[_ngcontent-%COMP%]{padding:8px}.pt-2[_ngcontent-%COMP%]{padding-top:8px}.pl-2[_ngcontent-%COMP%]{padding-left:8px}.pr-2[_ngcontent-%COMP%]{padding-right:8px}.pb-2[_ngcontent-%COMP%]{padding-bottom:8px}.p-3[_ngcontent-%COMP%]{padding:12px}.pt-3[_ngcontent-%COMP%]{padding-top:12px}.pl-3[_ngcontent-%COMP%]{padding-left:12px}.pr-3[_ngcontent-%COMP%]{padding-right:12px}.pb-3[_ngcontent-%COMP%]{padding-bottom:12px}.p-4[_ngcontent-%COMP%]{padding:16px}.pt-4[_ngcontent-%COMP%]{padding-top:16px}.pl-4[_ngcontent-%COMP%]{padding-left:16px}.pr-4[_ngcontent-%COMP%]{padding-right:16px}.pb-4[_ngcontent-%COMP%]{padding-bottom:16px}.p-5[_ngcontent-%COMP%]{padding:20px}.pt-5[_ngcontent-%COMP%]{padding-top:20px}.pl-5[_ngcontent-%COMP%]{padding-left:20px}.pr-5[_ngcontent-%COMP%]{padding-right:20px}.pb-5[_ngcontent-%COMP%]{padding-bottom:20px}.p-6[_ngcontent-%COMP%]{padding:24px}.pt-6[_ngcontent-%COMP%]{padding-top:24px}.pl-6[_ngcontent-%COMP%]{padding-left:24px}.pr-6[_ngcontent-%COMP%]{padding-right:24px}.pb-6[_ngcontent-%COMP%]{padding-bottom:24px}.p-auto[_ngcontent-%COMP%]{padding:auto}.pt-auto[_ngcontent-%COMP%]{padding-top:auto}.pl-auto[_ngcontent-%COMP%]{padding-left:auto}.pr-auto[_ngcontent-%COMP%]{padding-right:auto}.pb-auto[_ngcontent-%COMP%]{padding-bottom:auto}.mission-bar[_ngcontent-%COMP%]{border-radius:4px!important;height:100%;padding:2px!important;text-align:center}"],changeDetection:0}),e}(),A=n("XIAg"),W=function(){function e(e){this.dateTimeService=e}return e.prototype.transform=function(e,t){var n=this.dateTimeService.getWeekRangeByDateParams(e)[0];return(t||e.weekDay)&&n.setDate(n.getDate()+(t-1)||e.weekDay),n},e.\u0275fac=function(t){return new(t||e)(m["\u0275\u0275directiveInject"](p.g))},e.\u0275pipe=m["\u0275\u0275definePipe"]({name:"getDateByDateParams",type:e,pure:!0}),e}(),Y=n("RHY+");function q(e,t){if(1&e){var n=m["\u0275\u0275getCurrentView"]();m["\u0275\u0275elementStart"](0,"app-timesheet-mission-bar",8),m["\u0275\u0275listener"]("barClicked",(function(e){m["\u0275\u0275restoreView"](n);var i=t.$implicit,r=m["\u0275\u0275nextContext"](3);return i.status?r.openTimesheetCard(e):r.openTimesheetForm(void 0,e)})),m["\u0275\u0275elementEnd"]()}if(2&e){var i=t.$implicit;m["\u0275\u0275styleProp"]("height",i.totalHours/14*300,"px"),m["\u0275\u0275property"]("timesheet",i)}}function z(e,t){1&e&&m["\u0275\u0275element"](0,"mat-divider",9)}function J(e,t){if(1&e){var n=m["\u0275\u0275getCurrentView"]();m["\u0275\u0275elementContainerStart"](0),m["\u0275\u0275elementStart"](1,"div",3),m["\u0275\u0275elementStart"](2,"app-timesheet-day-label",4),m["\u0275\u0275listener"]("labelClicked",(function(e){return m["\u0275\u0275restoreView"](n),m["\u0275\u0275nextContext"](2).openTimesheetForm(e)})),m["\u0275\u0275pipe"](3,"getDateByDateParams"),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementStart"](4,"div",5),m["\u0275\u0275template"](5,q,1,3,"app-timesheet-mission-bar",6),m["\u0275\u0275pipe"](6,"sortByDate"),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"](),m["\u0275\u0275template"](7,z,1,0,"mat-divider",7),m["\u0275\u0275elementContainerEnd"]()}if(2&e){var i=t.$implicit,r=m["\u0275\u0275nextContext"]().$implicit;m["\u0275\u0275advance"](2),m["\u0275\u0275property"]("date",m["\u0275\u0275pipeBind2"](3,3,r.dateParams,i)),m["\u0275\u0275advance"](3),m["\u0275\u0275property"]("ngForOf",m["\u0275\u0275pipeBind2"](6,6,r.days[i],"startTime")),m["\u0275\u0275advance"](2),m["\u0275\u0275property"]("ngIf",7!==i)}}var H=function(){return[1,2,3,4,5]};function G(e,t){if(1&e){var n=m["\u0275\u0275getCurrentView"]();m["\u0275\u0275elementContainerStart"](0),m["\u0275\u0275elementStart"](1,"div",1),m["\u0275\u0275listener"]("swiperight",(function(){m["\u0275\u0275restoreView"](n);var e=t.$implicit;return m["\u0275\u0275nextContext"]().previousWeek(e.dateParams)}))("swipeleft",(function(){m["\u0275\u0275restoreView"](n);var e=t.$implicit;return m["\u0275\u0275nextContext"]().nextWeek(e.dateParams)})),m["\u0275\u0275template"](2,J,8,9,"ng-container",2),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementContainerEnd"]()}2&e&&(m["\u0275\u0275advance"](2),m["\u0275\u0275property"]("ngForOf",m["\u0275\u0275pureFunction0"](1,H)))}var U=function(){function e(e,t,n,i,r,a,o){var s=this;this.mainNavService=e,this.router=t,this.route=n,this.dialog=i,this._bottomSheet=r,this.dateTimeService=a,this.userTimesheetService=o,this.date=new Date,this.currentWeekNr=this.dateTimeService.getWeekOfYear(this.date),this.currentYear=this.date.getFullYear(),this.goToTimesheetList=function(){var e=s.getDateParams(s.route.snapshot.queryParams);s.router.navigate(["timer/liste",{returnRoute:s.router.url,dateRange:JSON.stringify(s.dateTimeService.getWeekRangeByDateParams(e))}])},this.goToWeekList=function(){return s.router.navigate(["timer/ukeliste"],{queryParams:{year:s.route.snapshot.queryParams.year}})},this.changeDateParams=function(e){return s.router.navigate(["timer/ukevisning"],{queryParams:{year:e.year,weekNr:e.weekNr}})},this.configureMainNav(this.getDateParams(this.route.snapshot.queryParams))}return e.prototype.ngOnInit=function(){this.initalizeObservable()},e.prototype.nextWeek=function(e){e.year==this.currentYear&&e.weekNr<this.currentWeekNr?e.weekNr++:e.year!=this.currentYear&&(e.weekNr>=this.dateTimeService.getWeeksInYear(e.year)?(e.year++,e.weekNr=1):e.weekNr++),this.changeDateParams(e)},e.prototype.previousWeek=function(e){e.weekNr<=1?(e.year--,e.weekNr=this.dateTimeService.getWeeksInYear(e.year)):e.weekNr--,this.changeDateParams(e)},e.prototype.openTimesheetForm=function(e,t){this._bottomSheet.open(N,{data:{datePreset:e,timesheetIdPreset:t}})},e.prototype.openTimesheetCard=function(e){this.dialog.open(u,{data:e,panelClass:"extended-dialog"})},e.prototype.initalizeObservable=function(){var e=this;this.vm$=this.route.queryParams.pipe(Object(r.a)((function(t){return e.getDateParams(t)})),Object(a.a)((function(t){return e.configureMainNav(t),e.userTimesheetService.getByWeekGrouped$(t).pipe(Object(r.a)((function(e){return{days:e,dateParams:t}})))})))},e.prototype.configureMainNav=function(e){var t={title:"Uke "+e.weekNr,subTitle:e.year.toString(),backFn:this.goToWeekList,buttons:[{icon:"list",callback:this.goToTimesheetList}]};this.mainNavService.addTopNavConfig({default:t})},e.prototype.getDateParams=function(e){return{year:+e.year||this.date.getFullYear(),weekNr:+e.weekNr||this.dateTimeService.getWeekOfYear(this.date)}},e.\u0275fac=function(t){return new(t||e)(m["\u0275\u0275directiveInject"](p.o),m["\u0275\u0275directiveInject"](i.b),m["\u0275\u0275directiveInject"](i.a),m["\u0275\u0275directiveInject"](o.b),m["\u0275\u0275directiveInject"](h.b),m["\u0275\u0275directiveInject"](p.g),m["\u0275\u0275directiveInject"](p.B))},e.\u0275cmp=m["\u0275\u0275defineComponent"]({type:e,selectors:[["app-timesheet-week-view"]],decls:2,vars:3,consts:[[4,"ngIf"],["fxLayout","row","fxLayoutAlign","start stretch",1,"h-100",3,"swiperight","swipeleft"],[4,"ngFor","ngForOf"],["fxLayout","column","fxLayoutAlign","start center",1,"w-100"],[1,"w-100","mb-1","fadeInDown",2,"z-index","1",3,"date","labelClicked"],["fxLayout","column","fxLayoutAlign","start center","fxFlex","",1,"w-100",2,"padding","0 2px 0 2px","z-index","0"],["class","w-100 mb-1 fadeInDown",3,"timesheet","height","barClicked",4,"ngFor","ngForOf"],["vertical","true",4,"ngIf"],[1,"w-100","mb-1","fadeInDown",3,"timesheet","barClicked"],["vertical","true"]],template:function(e,t){1&e&&(m["\u0275\u0275template"](0,G,3,2,"ng-container",0),m["\u0275\u0275pipe"](1,"async")),2&e&&m["\u0275\u0275property"]("ngIf",m["\u0275\u0275pipeBind1"](1,1,t.vm$))},directives:[d.l,P.c,P.b,d.k,R,P.a,$,A.a],pipes:[d.b,W,Y.a],encapsulation:2,changeDetection:0}),e}(),X=n("tkcm"),K=n("A9NE"),Q=n("7ESN"),Z=function(){function e(e,t,n,i,r){void 0===e&&(e=Q.a.Open),void 0===t&&(t=void 0),void 0===n&&(n=K.a.CurrentYear),void 0===i&&(i=[]),void 0===r&&(r=void 0),this.status=e,this.mission=t,this.dateRangePreset=n,this.dateRange=i,this.userName=r}return e.prototype.checkTimesheet=function(e){var t=e.status==this.status;if(this.userName&&null!==this.userName&&(t=t&&e.userName==this.userName),this.dateRange&&null!==this.dateRange){var n=new Date(e.startTime);t=t&&n>=this.dateRange[0]&&n<=this.dateRange[1]}return this.mission&&null!==this.mission&&(t=t&&e.missionId==this.mission.id),t},e}(),ee=n("pdUi");function te(e,t){if(1&e){var n=m["\u0275\u0275getCurrentView"]();m["\u0275\u0275elementStart"](0,"div",7),m["\u0275\u0275elementStart"](1,"app-timesheet-card",8),m["\u0275\u0275listener"]("deleteClicked",(function(e){return m["\u0275\u0275restoreView"](n),m["\u0275\u0275nextContext"](2).deleteTimesheet(e)}))("editClicked",(function(e){return m["\u0275\u0275restoreView"](n),m["\u0275\u0275nextContext"](2).openTimesheetForm(void 0,e)})),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"]()}if(2&e){var i=t.$implicit;m["\u0275\u0275advance"](1),m["\u0275\u0275property"]("timesheet",i)}}function ne(e,t){if(1&e&&(m["\u0275\u0275elementContainerStart"](0),m["\u0275\u0275elementStart"](1,"cdk-virtual-scroll-viewport",5),m["\u0275\u0275template"](2,te,2,1,"div",6),m["\u0275\u0275pipe"](3,"async"),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementContainerEnd"]()),2&e){var n=m["\u0275\u0275nextContext"]();m["\u0275\u0275advance"](2),m["\u0275\u0275property"]("cdkVirtualForOf",m["\u0275\u0275pipeBind1"](3,1,n.timesheets$))}}function ie(e,t){if(1&e){var n=m["\u0275\u0275getCurrentView"]();m["\u0275\u0275elementStart"](0,"span",9),m["\u0275\u0275elementStart"](1,"p"),m["\u0275\u0275text"](2,"Finner ingen timer med gitte filtre. "),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementStart"](3,"button",10),m["\u0275\u0275listener"]("click",(function(){return m["\u0275\u0275restoreView"](n),m["\u0275\u0275nextContext"]().openFilterSheet()})),m["\u0275\u0275text"](4,"\xc5pne filter"),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"]()}}var re=function(){function e(e,t,n,i,r,a){var o=this;this.mainNavService=e,this.route=t,this.router=n,this._bottomSheet=i,this.userTimesheetService=r,this.dateTimeService=a,this.timesheetStatus=f.g,this.deleteTimesheet=function(e){return o.userTimesheetService.delete$(e).subscribe()},this.getCurrentFilter=function(){return o.filterSubject.value},this.openFilterSheet=function(){o._bottomSheet.open(X.a,{data:{filter:o.getFilterCopy(),disabledFilters:["user"]}}).afterDismissed().pipe(Object(C.a)((function(e){return e instanceof Z}))).subscribe((function(e){return o.filterSubject.next(e)}))},this.onBack=function(){var e=o.route.snapshot.params.returnRoute;e?o.router.navigateByUrl(e):o.router.navigate([""])},this.configureMainNav()}return e.prototype.ngOnInit=function(){var e=this;this.filterSubject=new b.a(this.getInitialFilter()),this.timesheets$=this.filterSubject.asObservable().pipe(Object(a.a)((function(t){return e.userTimesheetService.getByWithMission$((function(e){return t.checkTimesheet(e)}))})))},e.prototype.openTimesheetForm=function(e,t){this._bottomSheet.open(N,{data:{missionPreset:e,timesheetIdPreset:t}})},e.prototype.changeStatus=function(e){var t=this.getFilterCopy();t.status=e,this.filterSubject.next(t)},e.prototype.getFilterCopy=function(){return Object.assign(Object.create(Object.getPrototypeOf(this.filterSubject.value)),this.filterSubject.value)},e.prototype.getInitialFilter=function(){var e=new Z;if(this.route.snapshot.params.mission&&(e.mission=JSON.parse(this.route.snapshot.params.mission)),this.route.snapshot.params.dateRange){e.dateRangePreset=f.a.Custom;var t=JSON.parse(this.route.snapshot.params.dateRange);t[0]=new Date(t[0]),t[1]=new Date(t[1]),e.dateRange=t}else this.route.snapshot.params.dateRangePreset?(e.dateRangePreset=this.route.snapshot.params.dateRangePreset,e.dateRange=this.dateTimeService.getRangeByDateRangePreset(this.route.snapshot.params.dateRangePreset)):(e.dateRangePreset=f.a.CurrentYear,e.dateRange=this.dateTimeService.getRangeByDateRangePreset(f.a.CurrentYear));return e},e.prototype.configureMainNav=function(){this.mainNavService.addTopNavConfig({default:{title:"Timeliste",backFn:this.onBack,buttons:[{icon:"filter_list",colorClass:"color-accent",callback:this.openFilterSheet}]}})},e.\u0275fac=function(t){return new(t||e)(m["\u0275\u0275directiveInject"](p.o),m["\u0275\u0275directiveInject"](i.a),m["\u0275\u0275directiveInject"](i.b),m["\u0275\u0275directiveInject"](h.b),m["\u0275\u0275directiveInject"](p.B),m["\u0275\u0275directiveInject"](p.g))},e.\u0275cmp=m["\u0275\u0275defineComponent"]({type:e,selectors:[["app-timesheet-list"]],decls:8,vars:4,consts:[["fxLayout","column","fxLayoutAlign","start stretch",1,"h-100","max-width"],["mat-fab","","aria-label","ny",1,"action_fab",3,"click"],[1,"scale-125"],[4,"ngIf","ngIfElse"],["noSheets",""],["itemSize","148","maxBufferPx","800","minBufferPx","800","fxFlex","",1,"fadeInRight"],["class","m-1",4,"cdkVirtualFor","cdkVirtualForOf"],[1,"m-1"],[3,"timesheet","deleteClicked","editClicked"],[1,"ppt-5","text-center","w-100"],["mat-raised-button","","color","accent",1,"bounceIn",3,"click"]],template:function(e,t){if(1&e&&(m["\u0275\u0275elementStart"](0,"div",0),m["\u0275\u0275elementStart"](1,"button",1),m["\u0275\u0275listener"]("click",(function(){return t.openTimesheetForm(t.getCurrentFilter().mission)})),m["\u0275\u0275elementStart"](2,"mat-icon",2),m["\u0275\u0275text"](3,"add"),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"](),m["\u0275\u0275template"](4,ne,4,3,"ng-container",3),m["\u0275\u0275pipe"](5,"async"),m["\u0275\u0275elementEnd"](),m["\u0275\u0275template"](6,ie,5,0,"ng-template",null,4,m["\u0275\u0275templateRefExtractor"])),2&e){var n,i=m["\u0275\u0275reference"](7),r=null==(n=m["\u0275\u0275pipeBind1"](5,2,t.timesheets$))?null:n.length;m["\u0275\u0275advance"](4),m["\u0275\u0275property"]("ngIf",r)("ngIfElse",i)}},directives:[P.c,P.b,M.b,E.a,d.l,ee.e,ee.a,P.a,ee.d,l.a],pipes:[d.b],encapsulation:2,changeDetection:0}),e}(),ae=n("NeHM"),oe=n("yMcq");function se(e,t){if(1&e){var n=m["\u0275\u0275getCurrentView"]();m["\u0275\u0275elementStart"](0,"div",4),m["\u0275\u0275listener"]("click",(function(){m["\u0275\u0275restoreView"](n);var e=t.$implicit,i=m["\u0275\u0275nextContext"]().$implicit;return m["\u0275\u0275nextContext"]().goToWeekView(i.year,e.week)})),m["\u0275\u0275element"](1,"app-timesheet-summary-card-content",5),m["\u0275\u0275elementEnd"]()}if(2&e){var i=t.$implicit;m["\u0275\u0275advance"](1),m["\u0275\u0275property"]("summary",i)}}function ce(e,t){if(1&e&&(m["\u0275\u0275elementStart"](0,"div",1),m["\u0275\u0275elementStart"](1,"cdk-virtual-scroll-viewport",2),m["\u0275\u0275template"](2,se,2,1,"div",3),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit,i=m["\u0275\u0275nextContext"]();m["\u0275\u0275advance"](2),m["\u0275\u0275property"]("cdkVirtualForOf",n.summaries)("cdkVirtualForTrackBy",i.trackByWeekNr)("cdkVirtualForTemplateCacheSize",0)}}var me=[{path:"",redirectTo:"ukevisning",pathMatch:"full"},{path:"ukevisning",component:U,canActivate:[p.d],data:{allowedRoles:[f.f.Leder,f.f.Mellomleder,f.f.Ansatt],animation:"TimesheetWeekView"}},{path:"ukeliste",component:function(){function e(e,t,n,i,r,a){var o=this;this._bottomSheet=e,this.dateTimeService=t,this.userTimesheetService=n,this.mainNavService=i,this.route=r,this.router=a,this.today=new Date,this.weekNr=this.dateTimeService.getWeekOfYear(this.today),this.goToWeekView=function(e,t){o.router.navigate(["/timer/ukevisning"],{queryParams:{year:e,weekNr:t}})},this.openWeekFilter=function(e){o._bottomSheet.open(ae.a,{data:{year:e}}).afterDismissed().pipe(Object(C.a)((function(e){return null!=e}))).subscribe((function(e){return o.updateYear(e.year)}))},this.updateYear=function(e){return o.router.navigate(["timer/ukeliste"],{queryParams:{year:e}})},this.configureMainNav=function(e){var t={title:"Ukeliste",subTitle:e?e.toString():o.today.getFullYear().toString()};t.buttons=[{icon:"filter_list",colorClass:"color-accent",callback:o.openWeekFilter,params:[e]}],o.mainNavService.addTopNavConfig({default:t})},this.configureMainNav(+this.route.snapshot.queryParamMap.year)}return e.prototype.ngOnInit=function(){var e=this;this.vm$=this.route.queryParams.pipe(Object(r.a)((function(t){return+t.year||e.today.getFullYear()})),Object(v.a)(this.configureMainNav),Object(a.a)((function(t){var n=t==e.today.getFullYear()?e.weekNr:e.dateTimeService.getWeeksInYear(t);return e.userTimesheetService.getByWeekRangeGrouped$(1,n,t).pipe(Object(r.a)((function(e){return{year:t,summaries:e.reverse()}})))})))},e.prototype.trackByWeekNr=function(e,t){return t.week},e.\u0275fac=function(t){return new(t||e)(m["\u0275\u0275directiveInject"](h.b),m["\u0275\u0275directiveInject"](p.g),m["\u0275\u0275directiveInject"](p.B),m["\u0275\u0275directiveInject"](p.o),m["\u0275\u0275directiveInject"](i.a),m["\u0275\u0275directiveInject"](i.b))},e.\u0275cmp=m["\u0275\u0275defineComponent"]({type:e,selectors:[["app-timesheet-week-list"]],decls:2,vars:3,consts:[["class","h-100 fadeInLeft  max-width","fxLayout","column","fxLayoutAlign","start stretch",4,"ngIf"],["fxLayout","column","fxLayoutAlign","start stretch",1,"h-100","fadeInLeft","max-width"],["itemSize","78","maxBufferPx","800","minBufferPx","800","fxFlex",""],["class","app-card mat-elevation-z2 m-1","matRipple","",3,"click",4,"cdkVirtualFor","cdkVirtualForOf","cdkVirtualForTrackBy","cdkVirtualForTemplateCacheSize"],["matRipple","",1,"app-card","mat-elevation-z2","m-1",3,"click"],[3,"summary"]],template:function(e,t){1&e&&(m["\u0275\u0275template"](0,ce,3,3,"div",0),m["\u0275\u0275pipe"](1,"async")),2&e&&m["\u0275\u0275property"]("ngIf",m["\u0275\u0275pipeBind1"](1,1,t.vm$))},directives:[d.l,P.c,P.b,ee.e,ee.a,P.a,ee.d,_.n,oe.a],pipes:[d.b],encapsulation:2,changeDetection:0}),e}(),canActivate:[p.d],data:{allowedRoles:[f.f.Leder,f.f.Mellomleder,f.f.Ansatt],animation:"TimesheetWeekList"}},{path:"liste",component:re,canActivate:[p.d],data:{allowedRoles:[f.f.Leder,f.f.Mellomleder,f.f.Ansatt],animation:"TimesheetList"}}],pe=function(){function e(){}return e.\u0275mod=m["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=m["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[i.f.forChild(me)],i.f]}),e}(),le=n("OYkh"),de=function(){function e(){}return e.\u0275mod=m["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=m["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[le.a,pe]]}),e}()}}]);