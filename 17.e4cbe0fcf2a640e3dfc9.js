(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{PvB8:function(e,t,n){"use strict";n.r(t),n.d(t,"MissionDocumentListModule",(function(){return N}));var i=n("DUip"),o=n("mrSG"),r=n("dzgT"),c=n("1YJq"),a=n("VnD/"),l=n("67Y/"),s=n("ny24"),u=n("1ua0"),d=n("1eh6"),p=n("h/AT"),m=n("TYT/"),f=n("dJ3e"),v=n("9qP0"),y=n("H5r2"),b=function(){function e(e,t,n,i){var o=this;this._missionDocumentService=e,this._notificationService=t,this._bottomSheetRef=n,this.data=i,this.close=function(e){return o._bottomSheetRef.dismiss(e)},this.mailDocuments=function(e){return o._missionDocumentService.mailDocuments$(e,o.data.ids).subscribe((function(e){o.close(!0),o._notificationService.setNotification("Vellykket! "+o.data.ids.length+" "+(o.data.ids.length>1?"dokumenter":"dokument")+" sendt")}))}}return e.prototype.ngOnInit=function(){this.navConfig={title:"Send dokumenter",leftBtn:{icon:"close",callback:this.close}}},e.\u0275fac=function(t){return new(t||e)(m["\u0275\u0275directiveInject"](f.p),m["\u0275\u0275directiveInject"](f.v),m["\u0275\u0275directiveInject"](p.d),m["\u0275\u0275directiveInject"](p.a))},e.\u0275cmp=m["\u0275\u0275defineComponent"]({type:e,selectors:[["app-mail-document-sheet"]],decls:2,vars:2,consts:[[3,"config"],[3,"toEmailPreset","formSubmitted"]],template:function(e,t){1&e&&(m["\u0275\u0275elementStart"](0,"app-simple-top-nav",0),m["\u0275\u0275elementStart"](1,"app-mail-to-form",1),m["\u0275\u0275listener"]("formSubmitted",(function(e){return t.mailDocuments(e)})),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"]()),2&e&&(m["\u0275\u0275property"]("config",t.navConfig),m["\u0275\u0275advance"](1),m["\u0275\u0275property"]("toEmailPreset",t.data.toEmailPreset))},directives:[v.a,y.a],encapsulation:2,changeDetection:0}),e}(),h=n("ea4N"),g=n("Valr"),S=n("EFs6"),k=n("GQZI"),I=n("GsDI"),w=n("hhBj"),x=n("wehj"),C=function(){function e(){}return e.prototype.transform=function(e){switch(e){case"csv":return c.d.Csv;case"pdf":return c.d.Pdf;case"jpg":case"png":return c.d.ImageFile;case"doc":case"docm":case"docx":case"dot":case"dotm":case"dotx":return c.d.Word;case"xla":case"xlam":case"xls":case"xlsb":case"xlsm":case"xlsx":case"xlt":case"xlw":return c.d.Excel;default:return c.d.DefaultFile}},e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=m["\u0275\u0275definePipe"]({name:"fileiconFromFiletype",type:e,pure:!0}),e}(),D=function(){function e(){}return e.prototype.transform=function(e){return e.split(".").pop()},e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=m["\u0275\u0275definePipe"]({name:"filetypeFromUrl",type:e,pure:!0}),e}();function j(e,t){if(1&e){var n=m["\u0275\u0275getCurrentView"]();m["\u0275\u0275elementStart"](0,"app-selectable-card",4),m["\u0275\u0275listener"]("selected",(function(){m["\u0275\u0275restoreView"](n);var e=t.$implicit;return m["\u0275\u0275nextContext"](2).toggleSelect(e)}))("click",(function(){m["\u0275\u0275restoreView"](n);var e=t.$implicit;return m["\u0275\u0275nextContext"](2).documentClick(e.entity)})),m["\u0275\u0275elementStart"](1,"div",5),m["\u0275\u0275element"](2,"mat-icon",6),m["\u0275\u0275pipe"](3,"fileiconFromFiletype"),m["\u0275\u0275pipe"](4,"filetypeFromUrl"),m["\u0275\u0275elementStart"](5,"div"),m["\u0275\u0275text"](6),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementStart"](7,"div",7),m["\u0275\u0275text"](8),m["\u0275\u0275pipe"](9,"uppercase"),m["\u0275\u0275pipe"](10,"filetypeFromUrl"),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementStart"](11,"div",7),m["\u0275\u0275text"](12,"Lastet opp 21.mai 2020"),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"]()}if(2&e){var i=t.$implicit;m["\u0275\u0275property"]("isSelected",i.selected),m["\u0275\u0275advance"](2),m["\u0275\u0275property"]("svgIcon",m["\u0275\u0275pipeBind1"](3,4,m["\u0275\u0275pipeBind1"](4,6,i.entity.fileURL))),m["\u0275\u0275advance"](4),m["\u0275\u0275textInterpolate"](null==i.entity.documentType?null:i.entity.documentType.name),m["\u0275\u0275advance"](2),m["\u0275\u0275textInterpolate1"]("Filtype: ",m["\u0275\u0275pipeBind1"](9,8,m["\u0275\u0275pipeBind1"](10,10,i.entity.fileURL)),"")}}function F(e,t){if(1&e&&(m["\u0275\u0275elementStart"](0,"div",2),m["\u0275\u0275template"](1,j,13,12,"app-selectable-card",3),m["\u0275\u0275pipe"](2,"arrayslice"),m["\u0275\u0275pipe"](3,"async"),m["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit,i=m["\u0275\u0275nextContext"]();m["\u0275\u0275advance"](1),m["\u0275\u0275property"]("ngForOf",m["\u0275\u0275pipeBind3"](2,2,m["\u0275\u0275pipeBind1"](3,6,i.selectableEntities$),n,i.totalRows))("ngForTrackBy",i.trackById)}}var E=function(e){function t(t){var n=e.call(this,t)||this;return n.totalRows=2,n.documentClicked=new m.EventEmitter,n}return Object(o.b)(t,e),t.prototype.toggleSelect=function(t){var n=this;this.clickDisabled=!0,e.prototype.toggleSelect.call(this,t),setTimeout((function(){return n.clickDisabled=!1}),500)},t.prototype.documentClick=function(e){this.clickDisabled||this.selectableListPresenter.isEntitySelected(e.id)||this.documentClicked.emit(e)},t.prototype.trackById=function(e,t){return t.entity.id},t.\u0275fac=function(e){return new(e||t)(m["\u0275\u0275directiveInject"](u.c))},t.\u0275cmp=m["\u0275\u0275defineComponent"]({type:t,selectors:[["app-document-list"]],inputs:{totalRows:"totalRows"},outputs:{documentClicked:"documentClicked"},features:[m["\u0275\u0275ProvidersFeature"]([u.c]),m["\u0275\u0275InheritDefinitionFeature"]],decls:3,vars:3,consts:[[1,"entity-row"],["class","entity-column",4,"ngFor","ngForOf"],[1,"entity-column"],["selectedText","Dokument valgt","selectedIcon","check_circle",3,"isSelected","selected","click",4,"ngFor","ngForOf","ngForTrackBy"],["selectedText","Dokument valgt","selectedIcon","check_circle",3,"isSelected","selected","click"],[1,"bg-foreground","text-center","mat-elevation-z2","p-2","pt-6","pb-6","m-1","fadeIn"],[1,"scale-150","mb-2",3,"svgIcon"],[1,"mat-caption"]],template:function(e,t){1&e&&(m["\u0275\u0275elementStart"](0,"div",0),m["\u0275\u0275template"](1,F,4,8,"div",1),m["\u0275\u0275pipe"](2,"arrayFromNumber"),m["\u0275\u0275elementEnd"]()),2&e&&(m["\u0275\u0275advance"](1),m["\u0275\u0275property"]("ngForOf",m["\u0275\u0275pipeBind1"](2,1,t.totalRows)))},directives:[g.k,k.a,I.a],pipes:[w.a,x.a,g.b,C,D,g.t],encapsulation:2}),t}(u.b),R=n("p+mS"),B=["documentList"];function T(e,t){if(1&e){var n=m["\u0275\u0275getCurrentView"]();m["\u0275\u0275elementStart"](0,"app-document-list",3,4),m["\u0275\u0275listener"]("selectionChanged",(function(e){return m["\u0275\u0275restoreView"](n),m["\u0275\u0275nextContext"]().currentSelections=e}))("documentClicked",(function(e){return m["\u0275\u0275restoreView"](n),m["\u0275\u0275nextContext"]().downloadDocument(e)})),m["\u0275\u0275pipe"](2,"async"),m["\u0275\u0275elementEnd"]()}if(2&e){var i=t.$implicit,o=m["\u0275\u0275nextContext"]();m["\u0275\u0275property"]("totalRows",m["\u0275\u0275pipeBind1"](2,2,o.isXs$)?2:4)("entities",i)}}function P(e,t){if(1&e){var n=m["\u0275\u0275getCurrentView"]();m["\u0275\u0275elementContainerStart"](0),m["\u0275\u0275elementStart"](1,"button",6),m["\u0275\u0275listener"]("click",(function(){m["\u0275\u0275restoreView"](n);var e=m["\u0275\u0275nextContext"](2);return e.openMailDocumentSheet(e.currentSelections)})),m["\u0275\u0275elementStart"](2,"mat-icon"),m["\u0275\u0275text"](3,"send"),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementStart"](4,"button",7),m["\u0275\u0275listener"]("click",(function(){m["\u0275\u0275restoreView"](n);var e=m["\u0275\u0275nextContext"](2);return e.openConfirmDeleteDialog(e.currentSelections)})),m["\u0275\u0275elementStart"](5,"mat-icon"),m["\u0275\u0275text"](6,"delete_forever"),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementContainerEnd"]()}}var $=function(e){return[e]};function _(e,t){if(1&e&&(m["\u0275\u0275elementContainerStart"](0),m["\u0275\u0275template"](1,P,7,0,"ng-container",5),m["\u0275\u0275elementContainerEnd"]()),2&e){var n=m["\u0275\u0275nextContext"]();m["\u0275\u0275advance"](1),m["\u0275\u0275property"]("ifRole",m["\u0275\u0275pureFunction1"](1,$,n.Roles.Leder))}}function O(e,t){if(1&e){var n=m["\u0275\u0275getCurrentView"]();m["\u0275\u0275elementStart"](0,"button",8),m["\u0275\u0275listener"]("click",(function(){return m["\u0275\u0275restoreView"](n),m["\u0275\u0275nextContext"]().openDocumentForm()})),m["\u0275\u0275elementStart"](1,"mat-icon"),m["\u0275\u0275text"](2,"note_add"),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"]()}}var V=[{path:"",component:function(e){function t(t,n,i,o,r,l,s,d,p,m,f){var v=e.call(this)||this;return v.deviceInfoService=t,v.bottomSheet=n,v.downloaderService=i,v.missionDocumentService=o,v.documentTypeService=r,v.missionService=l,v.notificationService=s,v.mainNavService=d,v.route=p,v.router=m,v.dialog=f,v.Roles=c.h,v.currentSelections=[],v.isXs$=v.deviceInfoService.isXs$,v.deleteDocuments=function(e){v.missionDocumentService.deleteRange$(e).subscribe((function(t){v.documentList.clearSelections(),v.notificationService.setNotification("Vellykket! "+e.length+" "+(e.length>1?"dokumenter":"dokument")+" slettet.")}))},v.openConfirmDeleteDialog=function(e){v.dialog.open(u.a,{data:"Bekreft at du \xf8nsker \xe5 slette utvalgte dokumenter."}).afterClosed().pipe(Object(a.a)((function(e){return e}))).subscribe((function(t){return v.deleteDocuments(e)}))},v.openMailDocumentSheet=function(e){v.bottomSheet.open(b,{data:{toEmailPreset:v.mission.employer?v.mission.employer.email:null,ids:e}}).afterDismissed().pipe(Object(a.a)((function(e){return e}))).subscribe((function(e){return v.documentList.clearSelections()}))},v.openDocumentForm=function(){return v.router.navigate(["skjema"],{relativeTo:v.route,queryParams:{missionId:v.missionId}})},v.downloadDocument=function(e){return v.downloaderService.downloadUrl(e.fileURL)},v.onBack=function(e){return v.router.navigate(["/oppdrag",e,"detaljer"])},v}return Object(o.b)(t,e),Object.defineProperty(t.prototype,"missionId",{get:function(){return+this.route.snapshot.paramMap.get("id")},enumerable:!0,configurable:!0}),t.prototype.ngOnInit=function(){var e=this;this.configureMainNav(this.missionId);var t=this.missionDocumentService.getByMissionId$(this.missionId),n=this.documentTypeService.getAll$();this.documentsWithType$=Object(r.a)(t,n).pipe(Object(l.a)((function(e){var t=Object(o.c)(e,2),n=t[1];return t[0].map((function(e){return e.documentType=n.find((function(t){return t.id==e.documentTypeId})),e}))}))),this.missionService.getDetails$(this.missionId).pipe(Object(s.a)(this.unsubscribe)).subscribe((function(t){return e.mission=t}))},t.prototype.configureMainNav=function(e){this.mainNavService.addTopNavConfig({default:{title:"Dokumenter",backFn:this.onBack,backFnParams:[e]}})},t.\u0275fac=function(e){return new(e||t)(m["\u0275\u0275directiveInject"](f.h),m["\u0275\u0275directiveInject"](p.b),m["\u0275\u0275directiveInject"](f.j),m["\u0275\u0275directiveInject"](f.p),m["\u0275\u0275directiveInject"](f.i),m["\u0275\u0275directiveInject"](f.s),m["\u0275\u0275directiveInject"](f.v),m["\u0275\u0275directiveInject"](f.o),m["\u0275\u0275directiveInject"](i.a),m["\u0275\u0275directiveInject"](i.b),m["\u0275\u0275directiveInject"](h.b))},t.\u0275cmp=m["\u0275\u0275defineComponent"]({type:t,selectors:[["app-mission-document-list"]],viewQuery:function(e,t){var n;1&e&&m["\u0275\u0275viewQuery"](B,!0),2&e&&m["\u0275\u0275queryRefresh"](n=m["\u0275\u0275loadQuery"]())&&(t.documentList=n.first)},features:[m["\u0275\u0275InheritDefinitionFeature"]],decls:5,vars:7,consts:[[3,"totalRows","entities","selectionChanged","documentClicked",4,"ngIf"],[4,"ngIf"],["mat-fab","","aria-label","ny","class","action_fab",3,"click",4,"ifRole"],[3,"totalRows","entities","selectionChanged","documentClicked"],["documentList",""],[4,"ifRole"],["mat-fab","","aria-label","ny",1,"action_fab_2",3,"click"],["mat-fab","","aria-label","ny",1,"action_fab_3","bg-warn",3,"click"],["mat-fab","","aria-label","ny",1,"action_fab",3,"click"]],template:function(e,t){1&e&&(m["\u0275\u0275template"](0,T,3,4,"app-document-list",0),m["\u0275\u0275pipe"](1,"async"),m["\u0275\u0275template"](2,_,2,3,"ng-container",1),m["\u0275\u0275template"](3,O,3,0,"button",2),m["\u0275\u0275element"](4,"router-outlet")),2&e&&(m["\u0275\u0275property"]("ngIf",m["\u0275\u0275pipeBind1"](1,3,t.documentsWithType$)),m["\u0275\u0275advance"](2),m["\u0275\u0275property"]("ngIf",t.currentSelections.length>0),m["\u0275\u0275advance"](1),m["\u0275\u0275property"]("ifRole",m["\u0275\u0275pureFunction1"](5,$,t.Roles.Leder)))},directives:[g.l,S.a,i.g,E,R.b,I.a],pipes:[g.b],encapsulation:2}),t}(d.a),children:[{path:"skjema",canActivate:[f.d],data:{allowedRoles:[c.h.Leder]},loadChildren:function(){return n.e(16).then(n.bind(null,"PEQ5")).then((function(e){return e.MissionDocumentFormModule}))}}]}],L=function(){function e(){}return e.\u0275mod=m["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=m["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[i.f.forChild(V)],i.f]}),e}(),M=n("PCNd"),N=function(){function e(){}return e.\u0275mod=m["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=m["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[M.a,L]]}),e}()}}]);